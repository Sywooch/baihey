var ar={currentDate:function(){var e=new Date;return e.getYear(),e.getFullYear(),e.getMonth(),e.getDate(),e.getDay(),e.getTime(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds(),e.toLocaleDateString(),e.toLocaleString()},currentYmd:function(){var e=new Date;return e.getFullYear()+""+e.getMonth()+e.getDate()},timeStamp:function(){return Date.parse(new Date)/1e3},isWeChat:function(){var e=navigator.userAgent.toLowerCase();return"micromessenger"==e.match(/MicroMessenger/i)?!0:!1},validateMobile:function(e){var t=/^1[34578]\d{9}$/;return t.test(e)},getPassByPhone:function(e){return isNaN(e)?e&&11==e.length?e.substring(-6):(alert("手机号格式不正确"),!1):e&&11==e.toString().length?e.toString().substring(e.toString().length,e.toString().length-6):(alert("手机号格式不正确"),!1)},getCookie:function(e){var t,a=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(a))?unescape(t[2]):null},setCookie:function(e,t,a){var o=a,n=new Date;n.setTime(n.getTime()+24*o*60*60*1e3),document.cookie=e+"="+escape(t)+";expires="+n.toGMTString()+";path=/wap"},delCookie:function(e){var t=new Date;t.setTime(t.getTime()-1);var a=this.getCookie(e);null!=a&&(document.cookie=e+"="+a+";expires="+t.toGMTString()+";path=/wap")},cookieUser:function(e){var t=30,a=new Date;a.setTime(a.getTime()+24*t*60*60*1e3),document.cookie="bhy_u_name="+escape(e)+";expires="+a.toGMTString()+";path=/"},trim:function(e){return e=e?e:"",e.replace(/(^\s*)|(\s*$)/g,"")},getQueryString:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),a=window.location.search.substr(1).match(t);return null!=a?unescape(a[2]):null},validatePass:function(e){var t=/^\w{6}$/;return t.test(e)},validateMoney:function(e){return/^\d+(\.\d{1,3})?$/.test(e)?!0:!1},msg_file_res_img:function(e){var t=e.name.toLowerCase().substr(e.name.lastIndexOf("."));return".jpg"==t||".png"==t||".bmp"==t||".gif"==t||".jpeg"==t?!0:!1},setStorage:function(e,t){t instanceof Object&&(t=JSON.stringify(t)),window.localStorage?localStorage.setItem(e,t):console.log("浏览器不支持localStorage")},getStorage:function(e){if(window.localStorage){var t=localStorage.getItem(e);return"undefined"!=t?t=JSON.parse(t):!1}console.log("浏览器不支持localStorage")},getId:function(e){var t=0;return t=void 0==e||0==e.length?1:parseInt(e[e.length-1].id)+1},DateTimeToDate:function(e){return"undefined"==typeof e?"":new Date(1e3*(e/1e3+86400)).toISOString().split("T")[0]},timesTampToDate:function(e){var t=new Date(1e3*e);return t.toLocaleString()},dateToTimestamp:function(e){return new Date(e).getTime()/1e3},getAgeByBirthday:function(e){var t=-1,a=e.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/);if(null==a)return!1;var o=new Date(a[1],a[3]-1,a[4]);if(o.getFullYear()==a[1]&&o.getMonth()+1==a[3]&&o.getDate()==a[4]){var n=(new Date).getFullYear(),i=(new Date).getMonth()+1,r=(new Date).getDate();return t=1*i-1*a[3]<0?1*n-1*a[1]-1:r-a[4]>=0?1*n-1*a[1]:1*n-1*a[1]-1}return t},getZodicByBirthday:function(e){var t=1997,a=new Date(e).getFullYear(),o=[{id:0,name:""}];return x=(t-a)%12,1==x||-11==x?(o.id=1,o.name="鼠"):0==x?(o.id=2,o.name="牛"):11==x||-1==x?(o.id=3,o.name="虎"):10==x||-2==x?(o.id=4,o.name="兔"):9==x||-3==x?(o.id=5,o.name="龙"):8==x||-4==x?(o.id=6,o.name="蛇"):7==x||-5==x?(o.id=7,o.name="马"):6==x||-6==x?(o.id=8,o.name="羊"):5==x||-7==x?(o.id=9,o.name="猴"):4==x||-8==x?(o.id=10,o.name="鸡"):3==x||-9==x?(o.id=11,o.name="狗"):(2==x||-10==x)&&(o.id=12,o.name="猪"),o},getConstellationByBirthday:function(e){var t=new Date(e).getDate(),a=new Date(e).getMonth()+1,o=[{id:0,name:""}];return(1==a&&t>=20||2==a&&18>=t)&&(o.id=1,o.name="水瓶座"),(2==a&&t>=19||3==a&&20>=t)&&(o.id=2,o.name="双鱼座"),(3==a&&t>=21||4==a&&19>=t)&&(o.id=3,o.name="白羊座"),(4==a&&t>=20||5==a&&20>=t)&&(o.id=4,o.name="金牛座"),(5==a&&t>=21||6==a&&21>=t)&&(o.id=5,o.name="双子座"),(6==a&&t>=22||7==a&&22>=t)&&(o.id=6,o.name="巨蟹座"),(7==a&&t>=23||8==a&&22>=t)&&(o.id=7,o.name="狮子座"),(8==a&&t>=23||9==a&&22>=t)&&(o.id=8,o.name="处女座"),(9==a&&t>=23||10==a&&23>=t)&&(o.id=9,o.name="天秤座"),(10==a&&t>=24||11==a&&22>=t)&&(o.id=10,o.name="天蝎座"),(11==a&&t>=23||12==a&&21>=t)&&(o.id=11,o.name="射手座"),(12==a&&t>=22||1==a&&19>=t)&&(o.id=12,o.name="摩羯座"),o},getTimestampByBirthday:function(e){return Math.round(new Date(e.replace(/-/g,"-")).getTime()/1e3)},heightLink:function(e){var t="",a=e,o=260;for(a;o>=a;a++)t+='<option value="',t+=a,t+='">',t+=a,t+="</option>";return t},getObjById:function(e,t){if("0"==t||"null"==t)return"0";for(var a in e)if(e[a].id==t)return e[a]},getArrI:function(arr,name,value){var filed="";for(var i in arr)if(filed=eval("arr[i]."+name),filed==value)return i;return!1},cleanQuotes:function(e){var t=e.replace(/"/g,"");return t},saveDataConfirm:function(e,t){var a=e.confirm({template:t,cancelText:"取消",okText:"确认"});return a},saveDataAlert:function(e,t){e.alert({template:t,okText:"确定"})},weiXinPayCallBack:function(e,t,a){function o(){WeixinJSBridge.invoke("getBrandWCPayRequest",t,function(t){e.get("http://wechat.baihey.com/wap/charge/order-query",{out_trade_no:a},function(t){t=JSON.parse(t),t.trade_state&&"SUCCESS"==t.trade_state?e.get("http://wechat.baihey.com/wap/charge/set-order-status",{orderId:a},function(e){e=JSON.parse(e),e.data?window.location.href="/wap/site/main#/charge_order?orderId="+a+"&payType=5":alert("设置订单状态失败")}):window.location.href="/wap/site/main#/charge_order?orderId="+a+"&payType=5"})})}"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",o,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",o),document.attachEvent("onWeixinJSBridgeReady",o)):o()},initPhotoSwipeFromDOM:function(e,t,a){requirejs(["photoswipe","photoswipe_ui"],function(o,n){for(var i=function(e){for(var e,t,a,o,n=e.childNodes,i=n.length,r=[],l=0;i>l;l++)if(e=n[l],1===e.nodeType&&(t=e.children,0!=t.length&&"/wechat/web/images/addPic.png"!=e.children[0].getAttribute("src"))){a=e.getAttribute("data-size").split("x"),o={src:e.getAttribute("href"),w:parseInt(a[0],10),h:parseInt(a[1],10),author:e.getAttribute("data-author")},o.el=e,t.length>0&&(o.msrc=t[0].getAttribute("src"),t.length>1&&(o.title=t[1].innerHTML));var c=e.getAttribute("data-med");c&&(a=e.getAttribute("data-med-size").split("x"),o.m={src:c,w:parseInt(a[0],10),h:parseInt(a[1],10)}),o.o={src:o.src,w:o.w,h:o.h},r.push(o)}return r},r=function g(e,t){return e&&(t(e)?e:g(e.parentNode,t))},l=function(e){e=e||window.event,e.preventDefault?e.preventDefault():e.returnValue=!1;var t=angular.element(e.target).attr("auth")?angular.element(e.target).attr("auth"):1;if(2==t)return ar.saveDataAlert(a,"暂时无法查看大图，对方已设置关注可看。"),!1;if(3==t)return ar.saveDataAlert(a,"暂时无法查看大图，对方已设置VIP会员可看。"),!1;if(4==t)return ar.saveDataAlert(a,"暂时无法查看大图，对方已设置不公开相册。"),!1;var o=e.target||e.srcElement,n=r(o,function(e){return"A"===e.tagName});if(n){for(var i,l=n.parentNode,c=n.parentNode.childNodes,d=c.length,f=0,u=0;d>u;u++)if(1===c[u].nodeType){if(c[u]===n){i=f;break}f++}return i>=0&&s(i,l),!1}},c=function(){var e=window.location.hash.substring(1),t={};if(e.length<5)return t;for(var a=e.split("&"),o=0;o<a.length;o++)if(a[o]){var n=a[o].split("=");n.length<2||(t[n[0]]=n[1])}return t.gid&&(t.gid=parseInt(t.gid,10)),t},s=function(e,a,r,l){var c,s,d,f=document.querySelectorAll(".pswp")[0];if(d=i(a),s={galleryUID:a.getAttribute("data-pswp-uid"),getThumbBoundsFn:function(e){var t=d[e].el.children[0],a=window.pageYOffset||document.documentElement.scrollTop,o=t.getBoundingClientRect();return{x:o.left,y:o.top+a,w:o.width}},addCaptionHTMLFn:function(e,t,a){return t.children[0].innerHTML="轻触照片退出",t.children[0].style.cssText="text-align:center;font-size:15px;",t.children[0].onclick=function(){c.close()},!0}},l)if(s.galleryPIDs){for(var u=0;u<d.length;u++)if(d[u].pid==e){s.index=u;break}}else s.index=parseInt(e,10)-1;else s.index=parseInt(e,10);if(!isNaN(s.index)){s.mainClass="pswp--minimal--dark",s.barsSize={top:0,bottom:0},s.captionEl=!0,s.fullscreenEl=!1,s.shareEl=!1,s.history=!1,s.bgOpacity=1,s.tapToClose=!0,s.tapToToggleControls=!1,s.closeEl=!1,r&&(s.showAnimationDuration=0),c=new o(f,n,d,s);var m,g,p=!1,v=!0;c.listen("beforeResize",function(){var e=window.devicePixelRatio?window.devicePixelRatio:1;e=Math.min(e,2.5),m=c.viewportSize.x*e,m>=1200||!c.likelyTouchDevice&&m>800||screen.width>1200?p||(p=!0,g=!0):p&&(p=!1,g=!0),g&&!v&&c.invalidateCurrItems(),v&&(v=!1),g=!1}),c.init(),t.$on("$ionicView.beforeLeave",function(){c.close()})}},d=document.querySelectorAll(e),f=0,u=d.length;u>f;f++)d[f].setAttribute("data-pswp-uid",f+1),d[f].onclick=l;var m=c();m.pid&&m.gid&&s(m.pid,d[m.gid-1],!0,!0)})},processData:function(e,t,a,o,n,i){function r(){t.provinceList=provines,t.cityList=citys,t.areaList=area}function l(){t.formData={},t.formData.went_travel=t.userInfo.went_travel?t.userInfo.went_travel.split(","):[],t.isMore=!0,t.typeTab=1,t.domestic=[],t.abroad=[],t.data=[],t.pageSize=1,a.list("/wap/member/went-travel-list",{}).success(function(e){t.data=e.data;for(var a in t.data){for(var o in t.formData.went_travel){if(t.formData.went_travel[o]==t.data[a].id){t.data[a].checked=!0;break}t.data[a].checked=!1}2==t.data[a].type&&0==t.data[a].parentId&&t.domestic.push(t.data[a]),3==t.data[a].type&&0==t.data[a].parentId&&t.abroad.push(t.data[a])}}),t.loadMore=function(e){1==e?t.pageSize==t.domestic.length&&(t.isMore=!1):t.pageSize==t.abroad.length&&(t.isMore=!1),t.pageSize+=1,t.$broadcast("scroll.infiniteScrollComplete")},t.moreDataCanBeLoaded=function(){return t.isMore},t.remove=function(e){for(var a in t.data)if(t.data[a].id==e.id){t.data[a].checked=!1;break}z(e,"went_travel"),i.$getByHandle("small").scrollTop()},t.scrollSmallToBottom=function(e,a){var r=n("filter")(t.data,{checked:!0});return r.length>6?(a.checked=!1,void ar.saveDataAlert(o,"您最多能选择6项！")):void(e.target.checked?(I(a,"went_travel"),i.$getByHandle("small").scrollBottom()):(z(a,"went_travel"),i.$getByHandle("small").scrollTop()))},t.showTab=function(e){t.typeTab=e}}function c(){t.bloodList=config_infoData.blood}function s(){t.carList=config_infoData.car}function d(){t.childrenList=config_infoData.children}function f(){t.formData={},t.formData.like_food=t.userInfo.like_food?t.userInfo.like_food.split(","):[],a.list("/wap/member/config-list",{type:3}).success(function(e){t.foodList=e.data;for(var a in t.foodList)for(var o in t.formData.like_food){if(t.foodList[a].id==t.formData.like_food[o]){t.foodList[a].checked=!0;break}t.foodList[a].checked=!1}}),t.remove=function(e){for(var a in t.foodList)if(t.foodList[a].id==e.id){t.foodList[a].checked=!1;break}z(da,"like_food"),i.$getByHandle("small").scrollTop()},t.scrollSmallToBottom=function(e,a){var r=n("filter")(t.foodList,{checked:!0});return r.length>6?(a.checked=!1,void ar.saveDataAlert(o,"您最多能选择6项！")):void(e.target.checked?(I(a,"like_food"),i.$getByHandle("small").scrollBottom()):(z(a,"like_food"),i.$getByHandle("small").scrollTop()))}}function u(){t.educationList=config_infoData.education}function m(){t.heightList=config_infoData.height}function g(){t.houseList=config_infoData.house}function p(){t.marriageList=config_infoData.marriage}function v(){t.formData={},t.formData.want_film=t.userInfo.want_film?t.userInfo.want_film.split(","):[],a.list("/wap/member/config-list",{type:2}).success(function(e){t.list=e.data;for(var a in t.list)for(var o in t.formData.want_film){if(t.list[a].id==t.formData.want_film[o]){t.list[a].checked=!0;break}t.list[a].checked=!1}}),t.remove=function(e){for(var a in t.list)if(t.list[a].id==e.id){t.list[a].checked=!1;break}z(e,"want_film"),i.$getByHandle("small").scrollTop()},t.scrollSmallToBottom=function(e,a){var r=n("filter")(t.list,{checked:!0});return r.length>6?(a.checked=!1,void ar.saveDataAlert(o,"您最多能选择6项！")):void(e.target.checked?(I(a,"want_film"),i.$getByHandle("small").scrollBottom()):(z(a,"want_film"),i.$getByHandle("small").scrollTop()))}}function h(){t.nationList=config_infoData.nation}function _(){t.occupationList=config_infoData.occupation,t.childrenOccupationList=config_infoData.children_occupation,t.userInfo.info.occupation=t.userInfo.info.occupation?t.userInfo.info.occupation:1,t.userInfo.info.children_occupation=t.userInfo.info.children_occupation?t.userInfo.info.children_occupation:1,t.bodyHeight=document.body.scrollHeight,0==t.bodyHeight&&(t.bodyHeight=window.screen.height),t.scrollStyle={height:t.bodyHeight-44+"px"},t.selected_big=function(e){t.userInfo.info.occupation=e.id,t.userInfo.info.children_occupation=0},t.selected_small=function(e){t.userInfo.info.children_occupation=e.id}}function w(){t.salaryList=config_infoData.salary}function D(){t.formData={},t.formData.love_sport=t.userInfo.love_sport?t.userInfo.love_sport.split(","):[],a.list("/wap/member/config-list",{type:1}).success(function(e){t.sportsList=e.data;for(var a in t.sportsList)for(var o in t.formData.love_sport){if(t.formData.love_sport[o]==t.sportsList[a].id){t.sportsList[a].checked=!0;break}t.sportsList[a].checked=!1}}),t.scrollSmallToBottom=function(e,a){var r=n("filter")(t.sportsList,{checked:!0});return r.length>6?(a.checked=!1,void ar.saveDataAlert(o,"您最多能选择6项！")):void(e.target.checked?(I(a,"love_sport"),i.$getByHandle("small").scrollBottom()):(z(a,"love_sport"),i.$getByHandle("small").scrollTop()))},t.remove=function(e){for(var a in t.sportsList)if(t.sportsList[a].id==e.id){t.sportsList[a].checked=!1;break}z(e,"love_sport"),i.$getByHandle("small").scrollTop()}}function k(){t.formData={},t.formData.want_travel=t.userInfo.want_travel?t.userInfo.want_travel.split(","):[],t.isMore=!0,t.typeTab=1,t.domestic=[],t.abroad=[],t.data=[],t.pageSize=1,a.list("/wap/member/went-travel-list",{}).success(function(e){t.data=e.data;for(var a in t.data){for(var o in t.formData.want_travel){if(t.formData.want_travel[o]==t.data[a].id){t.data[a].checked=!0;break}t.data[a].checked=!1}2==t.data[a].type&&0==t.data[a].parentId&&t.domestic.push(t.data[a]),3==t.data[a].type&&0==t.data[a].parentId&&t.abroad.push(t.data[a])}}),t.loadMore=function(e){1==e?t.pageSize==t.domestic.length&&(t.isMore=!1):t.pageSize==t.abroad.length&&(t.isMore=!1),t.pageSize+=1,t.$broadcast("scroll.infiniteScrollComplete")},t.moreDataCanBeLoaded=function(){return t.isMore},t.remove=function(e){for(var a in t.data)if(t.data[a].id==e.id){t.data[a].checked=!1;break}z(e,"want_travel"),i.$getByHandle("small").scrollTop()},t.scrollSmallToBottom=function(e,a){var r=n("filter")(t.data,{checked:!0});return r.length>6?(a.checked=!1,void ar.saveDataAlert(o,"您最多能选择6项！")):void(e.target.checked?(I(a,"want_travel"),i.$getByHandle("small").scrollBottom()):(z(a,"want_travel"),i.$getByHandle("small").scrollTop()))},t.showTab=function(e){t.typeTab=e}}function b(){t.formData={},t.constellationList=config_infoData.constellation,t.formData.zo_constellation=t.constellationList;for(var e in t.constellationList)for(var a in t.userInfo.info.zo_constellation){if(t.userInfo.info.zo_constellation[a]==t.constellationList[e].id){t.constellationList[e].checked=!0;break}t.constellationList[e].checked=!1}t.maxLength=function(e,a){var i=n("filter")(t.constellationList,{checked:!0});return i.length>3?(a.checked=!1,void ar.saveDataAlert(o,"您最多能选择3项！")):void 0}}function y(){t.formData={},t.marriageList=config_infoData.marriage,t.formData.zo_marriage=t.marriageList;for(var e in t.marriageList)for(var a in t.userInfo.info.zo_marriage){if(t.userInfo.info.zo_marriage[a]==t.marriageList[e].id){t.marriageList[e].checked=!0;break}t.marriageList[e].checked=!1}}function L(){t.formData={},t.zodiacList=config_infoData.zodiac,t.formData.zo_zodiac=t.zodiacList;for(var e in t.zodiacList)for(var a in t.userInfo.info.zo_zodiac){if(t.userInfo.info.zo_zodiac[a]==t.zodiacList[e].id){t.zodiacList[e].checked=!0;break}t.zodiacList[e].checked=!1}t.maxLength=function(e,a){var i=n("filter")(t.zodiacList,{checked:!0});return i.length>6?(a.checked=!1,void ar.saveDataAlert(o,"您最多能选择6项！")):void 0}}function I(e,a){"went_travel"==a&&t.formData.went_travel.push(e.id),"want_travel"==a&&t.formData.want_travel.push(e.id),"love_sport"==a&&t.formData.love_sport.push(e.id),"want_film"==a&&t.formData.want_film.push(e.id),"like_food"==a&&t.formData.like_food.push(e.id)}function z(e,a){if("went_travel"==a)for(var o in t.formData.went_travel)if(t.formData.went_travel[o]==e.id){t.formData.went_travel.splice(o,1);break}if("want_travel"==a)for(var o in t.formData.want_travel)if(t.formData.want_travel[o]==e.id){t.formData.want_travel.splice(o,1);break}if("love_sport"==a)for(var o in t.formData.love_sport)if(t.formData.love_sport[o]==e.id){t.formData.love_sport.splice(o,1);break}if("want_film"==a)for(var o in t.formData.want_film)if(t.formData.want_film[o]==e.id){t.formData.want_film.splice(o,1);break}if("like_food"==a)for(var o in t.formData.like_food)if(t.formData.like_food[o]==e.id){t.formData.like_food.splice(o,1);break}}"address"==e&&r(),"been_address"==e&&l(),"blood"==e&&c(),("car"==e||"zo_car"==e)&&s(),("children"==e||"zo_children"==e)&&d(),"delicacy"==e&&f(),("education"==e||"zo_education"==e)&&u(),"height"==e&&m(),("house"==e||"zo_house"==e)&&g(),"is_marriage"==e&&p(),"movie"==e&&v(),"nation"==e&&h(),"occupation"==e&&_(),"salary"==e&&w(),"sports"==e&&D(),"want_address"==e&&k(),"zo_constellation"==e&&b(),"zo_marriage"==e&&y(),"zo_zodiac"==e&&L()},processParams:function(e,t){if(!t)return!0;if(t.birthday&&(e.userInfo.info.age=t.birthday.getTime()/1e3,e.userInfo.info.zodiac=t.zodiac.id,e.userInfo.info.constellation=t.constellation.id),t.went_travel&&(e.userInfo.went_travel=t.went_travel.join(",")),t.want_travel&&(e.userInfo.want_travel=t.want_travel.join(",")),t.love_sport&&(e.userInfo.love_sport=t.love_sport.join(",")),t.want_film&&(e.userInfo.want_film=t.want_film.join(",")),t.like_food&&(e.userInfo.like_food=t.like_food.join(",")),t.zo_marriage){var a=[];for(var o in t.zo_marriage)t.zo_marriage[o].checked&&a.push(t.zo_marriage[o].id);e.userInfo.info.zo_marriage=a.join(",")}if(t.zo_zodiac){var n=[];for(var o in t.zo_zodiac)t.zo_zodiac[o].checked&&n.push(t.zo_zodiac[o].id);e.userInfo.info.zo_zodiac=n.join(",")}if(t.zo_constellation){var i=[];for(var o in t.zo_constellation)t.zo_constellation[o].checked&&i.push(t.zo_constellation[o].id);e.userInfo.info.zo_constellation=i.join(",")}e.getTravel("went_travel",e.userInfo.went_travel),e.getTravel("want_travel",e.userInfo.want_travel),e.getConfig("love_sport",e.userInfo.love_sport),e.getConfig("want_film",e.userInfo.want_film),e.getConfig("like_food",e.userInfo.like_food)},previewPictureByFileReader:function(e){if("undefined"!=typeof FileReader&&"undefined"!=typeof FormData){var t=new FileReader;t.readAsDataURL(e),t.onload=function(e){return"data:base64"==e.target.result.substr(0,11)?"data:application/octet-stream;"+e.target.result.substr(e.target.result.indexOf("base64,")):e.target.result}}},utf16toEntities:function(e){var t=/[\ud800-\udbff][\udc00-\udfff]/g;return e=e.replace(t,function(e){var t,a,o;return 2===e.length?(t=e.charCodeAt(0),a=e.charCodeAt(1),o=1024*(t-55296)+65536+a-56320,"&#"+o+";"):e})}};