define([],function(){var e={url:"ws://120.76.84.162:8080",name:"",esc:function(e){return null!=e&&""!=e?(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;"),encodeURIComponent(e)):void 0},flag:!0,socket:null};return e.sendMessage=function(n,o,t,s,c){null!=n&&""!=n&&void 0!=n&&this.socket.send("&message="+e.esc(n)+"&receiveId="+t+"&type="+s+"&sendId="+o+"&time="+c)},e.close=function(){this.flag=!1,this.socket.close()},e.init=function(n){if(this.socket=null,null==this.socket){this.socket=this.so(),this.name=n;var o=function(){console.log("x t b"),e.socket.send("&nr="+e.esc("heartbeat")+"&key=heartbeat")};window.setInterval(o,1e4)}return this.socket},e.so=function(){var n=new WebSocket(this.url);return n.onopen=function(){console.log("socket connecting"),1==e.socket.readyState&&e.socket.send("type=add&ming="+e.name)},n.onclose=function(){this.socket=null,n.close(),e.flag?(e.init(e.name),console.log("socket reload")):console.log("socket close")},n.onmessage=function(n){e.onMessageCallback(n)},n.onerror=function(){console.log("发生错误"),this.socket=null,n.close()},n},e});