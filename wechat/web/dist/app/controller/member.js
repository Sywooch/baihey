define(["app/module","app/directive/directiveApi","app/service/serviceApi","config/area"],function(module){return module.controller("member.index",["app.serviceApi","$scope","$ionicPopup",function(e,t,a){t.userInfo=ar.getStorage("userInfo"),t.userInfo.info=JSON.parse(t.userInfo.info),t.userInfo.auth=JSON.parse(t.userInfo.auth),t.loginOut=function(){e.save("/wap/member/login-out",{}).success(function(e){ar.delCookie("bhy_u_sex"),ar.delCookie("bhy_u_city"),ar.delCookie("bhy_user_id"),ar.delCookie("bhy_u_cityId"),ar.delCookie("bhy_u_cityPid"),localStorage.clear(),location.href="/wap/user/login"})},e.list("/wap/member/photo-list",{type:2,pageSize:2}).success(function(e){e.data.length&&(t.honestyStatus=e.data[0].is_check)}),e.list("/wap/member/user-headpic",{}).success(function(e){e.status&&(t.headpicStatus=e.data.is_check)}),t.honesty=function(e){return 1&e},t.discoveryNumber=0,e.list("/wap/member/get-dynamic-list",{user_id:t.userInfo.id}).success(function(e){e.status&&(t.discoveryNumber=e.data.length)}),t.$on("$ionicView.beforeEnter",function(a,o){e.list("/wap/follow/follow-list",{type:""}).success(function(e){t.followNumber=e.data})}),t.followNumber>0&&e.list("/wap/follow/set-checked",{user_id:t.userInfo.user_id}).success(function(e){console.log(e)})}]),module.controller("member.information",["app.serviceApi","$scope","$ionicPopup","FileUploader","$ionicLoading","$ionicActionSheet","$ionicModal","$ionicScrollDelegate","$filter","$rootScope","$location",function(e,t,a,o,r,i,n,s,c,l,u){t.userInfo=ar.getStorage("userInfo"),t.userInfo.info=JSON.parse(t.userInfo.info),t.userInfo.auth=JSON.parse(t.userInfo.auth),e.list("/wap/member/photo-list",{type:2,pageSize:2}).success(function(e){e.data.length&&(t.honestyStatus=e.data[0].is_check)});var f=t.uploader=new o({url:"/wap/file/thumb-photo"});t.formData={},t.imgList=[],e.list("/wap/member/photo-list",{}).success(function(e){t.imgList=e.data;var o=c("filter")(t.imgList,{is_check:1});t.isCheckNumber=o.length,ar.initPhotoSwipeFromDOM(".bhy-gallery",t,a)}),t.addNewImg=function(e){e.stopPropagation(),e.preventDefault();var o=document.getElementById("pic_fileInput"),r=document.createEvent("MouseEvents");r.initEvent("click",!0,!0),o.dispatchEvent(r),f.filters.push({name:"file-type-Res",fn:function(e){return ar.msg_file_res_img(e)?!0:(ar.saveDataAlert(a,"只能上传图片类型的文件！"),!1)}}),f.filters.push({name:"file-size-Res",fn:function(e){return e.size>8388608?(ar.saveDataAlert(a,"请选择小于8MB的图片！"),!1):!0}}),f.onAfterAddingFile=function(e){e.upload()},f.onProgressItem=function(e,a){t.showLoading(a)},f.onSuccessItem=function(e,o,r,i){o.status>0?t.imgList.push({id:o.id,thumb_path:o.thumb_path,is_head:0,is_check:2}):ar.saveDataAlert(a,"上传图片失败！")},f.onErrorItem=function(e,o,r,i){ar.saveDataAlert(a,"上传图片出错！"),t.hideLoading()},f.onCompleteItem=function(e,a,o,r){t.hideLoading()}},t.moreImg=function(o){var r=i.show({buttons:1==o.is_check&&0==o.is_head?[{text:"设为头像"}]:[],destructiveText:"删除",titleText:"操作照片",cancelText:"取消",destructiveButtonClicked:function(){var i=ar.saveDataConfirm(a,"是否确认删除该照片？");i.then(function(a){a?e.save("/wap/member/del-photo",{id:o.id}).success(function(e){if(1==o.is_head){t.userInfo.info.head_pic="",ar.setStorage("userInfo",t.userInfo);var a=ar.getStorage("userInfo");a.info=JSON.stringify(a.info),a.auth=JSON.stringify(a.auth),ar.setStorage("userInfo",a)}for(var i in t.imgList)o.id==t.imgList[i].id&&t.imgList.splice(i,1);r()}):r()})},buttonClicked:function(i){return e.save("/wap/member/set-head",{id:o.id,thumb_path:o.thumb_path}).success(function(e){if(e.status<1)ar.saveDataAlert(a,e.msg);else{for(var i in t.imgList)t.imgList[i].is_head=0,o.id==t.imgList[i].id&&(t.imgList[i].is_head=1);t.userInfo.info.head_pic=o.thumb_path,ar.setStorage("userInfo",t.userInfo);var n=ar.getStorage("userInfo");n.info=JSON.stringify(n.info),n.auth=JSON.stringify(n.auth),ar.setStorage("userInfo",n)}r()}),!0}})},t.dynamicList=[],e.list("/wap/member/get-dynamic-list",{user_id:t.userInfo.id,page:0}).success(function(e){for(var a in e.data)e.data[a].imgList=JSON.parse(e.data[a].pic),t.dynamicList.push(e.data[a])}),t.getTravel("went_travel",t.userInfo.went_travel),t.getTravel("want_travel",t.userInfo.want_travel),t.getConfig("love_sport",t.userInfo.love_sport),t.getConfig("want_film",t.userInfo.want_film),t.getConfig("like_food",t.userInfo.like_food),t.updateInfo=function(o){return o?(n.fromTemplateUrl("/wechat/web/templates/"+o+".html",{scope:t,animation:"slide-in-right"}).then(function(r){t.infoModal=r,t.infoModal.show()&&ar.processData(o,t,e,a,c,s)}),void(t.saveClose=function(){t.userInfo=ar.getStorage("userInfo"),t.userInfo.info=JSON.parse(t.userInfo.info),t.userInfo.auth=JSON.parse(t.userInfo.auth),t.infoModal.hide()})):!1},t.settingsBirthday={theme:"mobiscroll",lang:"zh",controls:["date"]},t.formData.age=" ",t.formData.zodiac={id:0,name:" "},t.formData.constellation={id:0,name:" "},t.birthdayChange=function(){t.userInfo.age=ar.getAgeByBirthday(ar.DateTimeToDate(t.formData.birthday)),t.formData.age=t.userInfo.age+"岁",t.formData.zodiac=ar.getZodicByBirthday(ar.DateTimeToDate(t.formData.birthday)),t.formData.constellation=ar.getConstellationByBirthday(ar.DateTimeToDate(t.formData.birthday))};for(var m=[],p=[],d=18;99>=d;d++)p.push(d),99>d&&m.push(d);t.settingsAge={theme:"mobiscroll",lang:"zh",rows:5,wheels:[[{circular:!1,data:m,label:"最低年龄"},{circular:!1,data:p,label:"最高年龄"}]],showLabel:!0,minWidth:130,cssClass:"md-pricerange",validate:function(e,t){var a,o=e.values,r=[];for(a=0;a<p.length;++a)p[a]<=o[0]&&r.push(p[a]);return{disabled:[[],r]}},formatValue:function(e){return e[0]+"-"+e[1]},parseValue:function(e){return e?e.replace(/\s/gi,"").split("-"):[18,22]}};for(var h=[],v=[],d=140;260>=d;d++)v.push(d),260>d&&h.push(d);t.settingsHeight={theme:"mobiscroll",lang:"zh",rows:5,wheels:[[{circular:!1,data:h,label:"最低身高(厘米)"},{circular:!1,data:v,label:"最高身高(厘米)"}]],showLabel:!0,minWidth:130,cssClass:"md-pricerange",validate:function(e,t){var a,o=e.values,r=[];for(a=0;a<v.length;++a)v[a]<=o[0]&&r.push(v[a]);return{disabled:[[],r]}},formatValue:function(e){return e[0]+"-"+e[1]},parseValue:function(e){return e?e.replace(/\s/gi,"").split("-"):[160,180]}},l.$on("$ionicView.beforeLeave",function(e,a){a.stateParams&&t.infoModal&&t.infoModal.isShown()&&t.closeModal()}),t.saveData=function(a){ar.processParams(t,a),e.save("/wap/member/save-data",t.userInfo).success(function(e){ar.setStorage("userInfo",t.userInfo);var a=ar.getStorage("userInfo");a.info=JSON.stringify(a.info),a.auth=JSON.stringify(a.auth),ar.setStorage("userInfo",a)})["finally"](function(){t.closeModal()})},t.closeModal=function(){t.infoModal.hide(),t.infoModal.remove()}}]),module.controller("member.admin_information",["app.serviceApi","$scope","$ionicPopup","FileUploader","$ionicLoading","$ionicActionSheet","$ionicModal","$ionicScrollDelegate","$filter","$rootScope","$location",function(e,t,a,o,r,i,n,s,c,l,u){t.userInfo=ar.getStorage("userInfo"),t.userInfo.info=JSON.parse(t.userInfo.info),t.userInfo.auth=JSON.parse(t.userInfo.auth),e.list("/wap/member/photo-list",{type:2,pageSize:2}).success(function(e){e.data.length&&(t.honestyStatus=e.data[0].is_check)});var f=t.uploader=new o({url:"/wap/file/thumb-photo"});t.formData={},t.imgList=[],e.list("/wap/member/photo-list",[]).success(function(e){t.imgList=e.data,ar.initPhotoSwipeFromDOM(".bhy-gallery",t,a)}),t.addNewImg=function(){var e=document.getElementById("pic_fileInput"),o=document.createEvent("MouseEvents");o.initEvent("click",!0,!0),e.dispatchEvent(o),f.filters.push({name:"file-type-Res",fn:function(e){return ar.msg_file_res_img(e)?!0:(ar.saveDataAlert(a,"只能上传图片类型的文件！"),!1)}}),f.filters.push({name:"file-size-Res",fn:function(e){return e.size>8388608?(ar.saveDataAlert(a,"请选择小于8MB的图片！"),!1):!0}}),f.onAfterAddingFile=function(e){e.upload()},f.onProgressItem=function(e,a){t.showLoading(a)},f.onSuccessItem=function(e,o,r,i){o.status>0?t.imgList.push({id:o.id,thumb_path:o.thumb_path,is_head:0}):ar.saveDataAlert(a,"上传图片失败！")},f.onErrorItem=function(e,o,r,i){ar.saveDataAlert(a,"上传图片出错！"),t.hideLoading()},f.onCompleteItem=function(e,a,o,r){t.hideLoading()}},t.moreImg=function(o){if(0==o)return!1;var r=t.imgList[o].id,n=(t.imgList[o].thumb_path,i.show({destructiveText:"删除",titleText:"操作照片",cancelText:"取消",destructiveButtonClicked:function(){var i=ar.saveDataConfirm(a,"是否确认删除该照片？");i.then(function(a){a?e.save("/wap/member/del-photo",{id:r}).success(function(e){t.imgList.splice(o,1),n()}):n()})},buttonClicked:function(e){return!0}}))},t.dynamicList=[],e.list("/wap/member/get-dynamic-list",{user_id:t.userInfo.id,page:0}).success(function(e){for(var a in e.data)e.data[a].imgList=JSON.parse(e.data[a].pic),t.dynamicList.push(e.data[a])}),t.getTravel("went_travel",t.userInfo.went_travel),t.getTravel("want_travel",t.userInfo.want_travel),t.getConfig("love_sport",t.userInfo.love_sport),t.getConfig("want_film",t.userInfo.want_film),t.getConfig("like_food",t.userInfo.like_food),t.updateInfo=function(o){return o?void n.fromTemplateUrl("/wechat/web/templates/"+o+".html",{scope:t,animation:"slide-in-right"}).then(function(r){t.infoModal=r,t.infoModal.show()&&ar.processData(o,t,e,a,c,s)}):!1},t.settingsBirthday={theme:"mobiscroll",lang:"zh",controls:["date"]},t.formData.age="年龄",t.formData.zodiac={id:0,name:"生肖"},t.formData.constellation={id:0,name:"星座"},t.birthdayChange=function(){t.userInfo.age=ar.getAgeByBirthday(ar.DateTimeToDate(t.formData.birthday)),t.formData.age=t.userInfo.age+"岁",t.formData.zodiac=ar.getZodicByBirthday(ar.DateTimeToDate(t.formData.birthday)),t.formData.constellation=ar.getConstellationByBirthday(ar.DateTimeToDate(t.formData.birthday))};for(var m=[],p=[],d=18;99>=d;d++)p.push(d),99>d&&m.push(d);t.settingsAge={theme:"mobiscroll",lang:"zh",rows:5,wheels:[[{circular:!1,data:m,label:"最低年龄"},{circular:!1,data:p,label:"最高年龄"}]],showLabel:!0,minWidth:130,cssClass:"md-pricerange",validate:function(e,t){var a,o=e.values,r=[];for(a=0;a<p.length;++a)p[a]<=o[0]&&r.push(p[a]);return{disabled:[[],r]}},formatValue:function(e){return e[0]+"-"+e[1]},parseValue:function(e){return e?e.replace(/\s/gi,"").split("-"):[18,22]}};for(var h=[],v=[],d=140;260>=d;d++)v.push(d),260>d&&h.push(d);t.settingsHeight={theme:"mobiscroll",lang:"zh",rows:5,wheels:[[{circular:!1,data:h,label:"最低身高(厘米)"},{circular:!1,data:v,label:"最高身高(厘米)"}]],showLabel:!0,minWidth:130,cssClass:"md-pricerange",validate:function(e,t){var a,o=e.values,r=[];for(a=0;a<v.length;++a)v[a]<=o[0]&&r.push(v[a]);return{disabled:[[],r]}},formatValue:function(e){return e[0]+"-"+e[1]},parseValue:function(e){return e?e.replace(/\s/gi,"").split("-"):[160,180]}},l.$on("$ionicView.beforeLeave",function(e,a){a.stateParams&&t.infoModal&&t.infoModal.isShown()&&t.closeModal()}),t.saveData=function(a){ar.processParams(t,a),e.save("/wap/member/save-data",t.userInfo).success(function(e){ar.setStorage("userInfo",t.userInfo);var a=ar.getStorage("userInfo");a.info=JSON.stringify(a.info),a.auth=JSON.stringify(a.auth),ar.setStorage("userInfo",a)})["finally"](function(){t.closeModal()})},t.closeModal=function(){t.infoModal.hide(),t.infoModal.remove()}}]),module.controller("member.discovery",["app.serviceApi","$scope","$ionicPopup","$location","$ionicModal","$ionicActionSheet",function(e,t,a,o,r,i){t.formData={},t.formData.auth=1,t.discoveryList=[],t.pageSize=5,e.list("/wap/member/get-dynamic-list",{user_id:t.userInfo.id,limit:1e4}).success(function(e){if(e.data.length<1)return!1;for(var o in e.data)e.data[o].imgList=JSON.parse(e.data[o].pic),e.data[o].real_name=e.data[o].real_name.replace(/\"/g,""),e.data[o].head_pic=e.data[o].head_pic.replace(/\"/g,""),e.data[o].level=e.data[o].level.replace(/\"/g,""),e.data[o].age=e.data[o].age.replace(/\"/g,"");t.discoveryList=e.data,ar.initPhotoSwipeFromDOM(".bhy-gallery",t,a)}),t.display=ar.getStorage("display")?ar.getStorage("display"):[],t.indexFilter=function(e){return-1==t.display.indexOf(e.id)},t.jump=function(e){o.url(e)},t.more=function(a,o){i.show({buttons:[{text:"删除"}],titleText:"更多",cancelText:"取消",cancel:function(){},buttonClicked:function(r,i){return 0==r&&(t.display.push(a),ar.setStorage("display",t.display),e.save("/wap/member/delete-dynamic",{id:a}).success(function(e){t.discoveryList.splice(o,1)})),!0}})},t.clickLike=function(a){var o=ar.getArrI(t.discoveryList,"id",a.id),r=0;t.discoveryList[o].cid>0?(r=-1,t.discoveryList[o].cid=-1):(r=1,t.discoveryList[o].cid=1),t.discoveryList[o].like_num=parseInt(t.discoveryList[o].like_num)+r,e.save("/wap/member/set-click-like",{dynamicId:a.id,add:r})},t.pageSize=5,t.isMore=!0,t.loadMore=function(){t.pageSize>t.discoveryList.length&&(t.isMore=!1),t.$broadcast("scroll.infiniteScrollComplete"),t.pageSize+=5},t.moreDataCanBeLoaded=function(){return t.isMore},e.get("/wap/member/comment-num",{}).success(function(e){ar.setStorage("discoverySum",e.data)})}]),module.controller("member.discovery_add",["app.serviceApi","$scope","$rootScope","$ionicPopup","$location","$ionicActionSheet","FileUploader","$ionicLoading","$state",function(e,t,a,o,r,i,n,s,c){var l=t.uploader=new n({url:"/wap/file/thumb"});t.reportData={},t.formData={},t.formData.auth=1,t.imgList=[],t.showLoading=function(e){s.show({template:'<p class="tac">上传中...</p><p class="tac">'+e+"%</p>"})},t.hideLoading=function(){s.hide()};var u=0;t.addNewImg=function(){var e=document.getElementById("pic_fileInput"),a=document.createEvent("MouseEvents");a.initEvent("click",!0,!0),e.dispatchEvent(a),l.filters.push({name:"file-type-Res",fn:function(e){return ar.msg_file_res_img(e)?!0:(ar.saveDataAlert(o,"只能上传图片类型的文件！"),!1)}}),l.filters.push({name:"file-size-Res",fn:function(e){return e.size>8388608?(ar.saveDataAlert(o,"请选择小于8MB的图片！"),!1):!0}}),l.onAfterAddingFile=function(e){e.upload()},l.onProgressItem=function(e,a){t.showLoading(a)},l.onSuccessItem=function(e,a,r,i){a.status>0?t.imgList.push({id:u+1,thumb_path:a.thumb_path}):ar.saveDataAlert(o,"上传图片失败！"),ar.initPhotoSwipeFromDOM(".bhy-gallery",t,o)},l.onErrorItem=function(e,a,r,i){ar.saveDataAlert(o,"上传图片出错！"),t.hideLoading()},l.onCompleteItem=function(e,a,o,r){t.hideLoading()}},t.delImg=function(e,a){e.stopPropagation(),e.preventDefault(),t.imgList.splice(a,1)},t.saveData=function(){var i=ar.getStorage("userInfo");if(i.info=JSON.parse(i.info),i.auth=JSON.parse(i.auth),!i.info.head_pic)return o.alert({template:"没有头像不可以发布动态哦，点击确定去设置头像！",okText:"确定"}).then(function(){r.url("/member/information")}),!1;s.show({template:"发布中..."});var i=ar.getStorage("userInfo");t.formData.name=JSON.parse(i.info).real_name,t.formData.pic=JSON.stringify(t.imgList),e.save("/wap/member/add-user-dynamic",t.formData).success(function(e){ar.saveDataAlert(o,e.msg),e.status?r.$$search.tempUrl?(r.url(r.$$search.tempUrl),console.log(r.$$search.tempUrl)):(r.url("/discovery"),a.$broadcast("reload",1)):window.location.reload()}).error(function(e){alert(e)})["finally"](function(){s.hide()})}}]),module.controller("member.follow",["app.serviceApi","$scope","$ionicPopup","$ionicLoading","$location","$ionicActionSheet",function(e,t,a,o,r,i){t.followType=void 0==ar.getCookie("follow")?"follow":ar.getCookie("follow"),t.followList=[],t.followedList=[],e.list("/wap/follow/set-checked",{user_id:t.userInfo.user_id}).success(function(e){console.log(e)}),e.list("/wap/follow/follow-list",{type:"follow"}).success(function(e){for(var a in e.data)e.data[a].info=JSON.parse(e.data[a].info),e.data[a].auth=JSON.parse(e.data[a].auth);t.followList=e.data}),e.list("/wap/follow/follow-list",{type:"followed"}).success(function(e){for(var a in e.data)e.data[a].info=JSON.parse(e.data[a].info),e.data[a].auth=JSON.parse(e.data[a].auth);t.followedList=e.data}),t.delFollow=function(o,r,i){angular.element(i.target).parent().parent().addClass("item-remove-animate"),e.get("/wap/follow/del-follow",{user_id:ar.getCookie("bhy_user_id"),follow_id:o.user_id}).success(function(e){e.data?t.followList.splice(r,1):ar.saveDataAlert(a,"取消关注失败")})},t.switching=function(e){t.followType=e,ar.setCookie("follow",e)}}]),module.controller("member.user_info",["app.serviceApi","$scope","$timeout","$ionicPopup","$ionicModal","$ionicActionSheet","$ionicLoading","$location","dataFilter",function(api,$scope,$timeout,$ionicPopup,$ionicModal,$ionicActionSheet,$ionicLoading,$location,dataFilter){$scope.formData={};var userInfo=ar.getStorage("userInfo");null!=userInfo&&(userInfo.info=JSON.parse(userInfo.info),userInfo.auth=JSON.parse(userInfo.auth));var getTravel=function(name,serId){if(null!=serId&&serId){var arrSer=serId.split(",");eval("$scope."+name+"_count = "+arrSer.length),api.list("/wap/member/get-travel-list",{area_id:serId}).success(function(res){eval("$scope."+name+" = "+JSON.stringify(res.data))})}else eval("$scope."+name+"_count = 0")},getConfig=function(name,serId){if(null!=serId){var arrSer=serId.split(",");eval("$scope."+name+"_count = "+arrSer.length),api.list("/wap/member/get-config-list",{config_id:serId}).success(function(res){eval("$scope."+name+" = "+JSON.stringify(res.data))})}else eval("$scope."+name+"_count = 0")},is_privacy=function(e){switch(e){case"1":return 1;case"2":return-1!=dataFilter.data.follow.indexOf($scope.formData.userId)?1:2;case"3":return $scope.userInfo.info.level>0?1:3;case"4":return 4;default:return!1}};$scope.formData.userId=$location.$$search.userId,$scope.otherUserInfo=[],$scope.imgList=[],$scope.dynamicList=[],$scope.formData.isfollow="2",api.list("/wap/member/user-info-page-by-id",{id:$scope.formData.userId}).success(function(e){if(e.status){if($scope.otherUserInfo=e.userInfo,$scope.otherUserInfo.info=JSON.parse($scope.otherUserInfo.info),$scope.otherUserInfo.auth=JSON.parse($scope.otherUserInfo.auth),$scope.imgList=e.userPhoto.length>0?e.userPhoto:[],ar.initPhotoSwipeFromDOM(".bhy-gallery",$scope,$ionicPopup),e.dynamic)for(var t in e.dynamic)e.dynamic[t].imgList=JSON.parse(e.dynamic[t].pic),$scope.dynamicList.push(e.dynamic[t]);$scope.formData.isfollow=e.followStatus,$scope.formData.followed=e.followedStatus,$scope.qqAuth=is_privacy($scope.otherUserInfo.privacy_qq),$scope.wxAuth=is_privacy($scope.otherUserInfo.privacy_wechat),$scope.picAuth=is_privacy($scope.otherUserInfo.privacy_pic),$scope.otherUserInfo.went_travel?getTravel("went_travel",$scope.otherUserInfo.went_travel):!0,$scope.otherUserInfo.want_travel?getTravel("want_travel",$scope.otherUserInfo.want_travel):!0,$scope.otherUserInfo.love_sport?getConfig("love_sport",$scope.otherUserInfo.love_sport):!0,$scope.otherUserInfo.want_film?getConfig("want_film",$scope.otherUserInfo.want_film):!0,$scope.otherUserInfo.like_food?getConfig("like_food",$scope.otherUserInfo.like_food):!0,console.info("isfollow:",e.followStatus,"followedStatus:",e.followedStatus)}}),$scope.localChat=function(){window.location.hash="#/chat1?id="+$scope.otherUserInfo.id+"&head_pic="+$scope.otherUserInfo.info.head_pic+"&real_name="+$scope.otherUserInfo.info.real_name+"&sex="+$scope.otherUserInfo.sex+"&age="+$scope.otherUserInfo.info.age};var followData={};followData.user_id=ar.getCookie("bhy_user_id"),followData.follow_id=$scope.formData.userId,$scope.addFollow=function(){return followData.user_id==followData.follow_id?void ar.saveDataAlert($ionicPopup,"您不能关注自己"):-1!=dataFilter.data.blacked.indexOf(followData.follow_id)?void ar.saveDataAlert($ionicPopup,"您已被对方设置黑名单，关注失败"):void api.save("/wap/follow/add-follow",followData).success(function(e){e.data&&(document.getElementsByClassName("transition")[0].style.transition="all 0.5s",document.getElementsByClassName("transition")[1].style.transition="all 0.5s",$scope.formData.isfollow=1,ar.saveDataAlert($ionicPopup,"关注成功"))})}}]),module.controller("member.admin_info",["app.serviceApi","$scope","$timeout","$ionicPopup","$ionicModal","$ionicActionSheet","$ionicLoading","$location","dataFilter",function(api,$scope,$timeout,$ionicPopup,$ionicModal,$ionicActionSheet,$ionicLoading,$location,dataFilter){$scope.formData=[];var userInfo=ar.getStorage("userInfo");null!=userInfo&&(userInfo.info=JSON.parse(userInfo.info),userInfo.auth=JSON.parse(userInfo.auth));var getTravel=function(name,serId){if(null!=serId&&serId){var arrSer=serId.split(",");eval("$scope."+name+"_count = "+arrSer.length),api.list("/wap/member/get-travel-list",{area_id:serId}).success(function(res){eval("$scope."+name+" = "+JSON.stringify(res.data))})}else eval("$scope."+name+"_count = 0")},getConfig=function(name,serId){if(null!=serId){var arrSer=serId.split(",");eval("$scope."+name+"_count = "+arrSer.length),api.list("/wap/member/get-config-list",{config_id:serId}).success(function(res){eval("$scope."+name+" = "+JSON.stringify(res.data))})}else eval("$scope."+name+"_count = 0")},is_privacy=function(e){switch(e){case"1":return!0;case"2":return 1==$scope.formData.followed?!0:!1;case"3":return $scope.otherUserInfo.info.level>0?!0:!1;case"4":return!1;default:return!1}};$scope.formData.userId=$location.$$search.userId,$scope.otherUserInfo=[],$scope.imgList=[],$scope.dynamicList=[],$scope.formData.isfollow="2",api.list("/wap/member/user-info-page-by-id",{id:$scope.formData.userId}).success(function(e){if(e.status){if($scope.otherUserInfo=e.userInfo,$scope.authUserInfo=e.authUserInfo,$scope.otherUserInfo.info=JSON.parse($scope.otherUserInfo.info),$scope.otherUserInfo.auth=JSON.parse($scope.otherUserInfo.auth),$scope.imgList=e.userPhoto.length>0?e.userPhoto:[],ar.initPhotoSwipeFromDOM(".bhy-gallery",$scope,$ionicPopup),e.dynamic)for(var t in e.dynamic)e.dynamic[t].imgList=JSON.parse(e.dynamic[t].pic),$scope.dynamicList.push(e.dynamic[t]);$scope.formData.isfollow=e.followStatus,$scope.formData.followed=e.followedStatus,$scope.qqAuth=is_privacy($scope.otherUserInfo.privacy_qq),$scope.wxAuth=is_privacy($scope.otherUserInfo.privacy_wechat),$scope.picAuth=is_privacy($scope.otherUserInfo.privacy_pic),$scope.otherUserInfo.went_travel?getTravel("went_travel",$scope.otherUserInfo.went_travel):!0,$scope.otherUserInfo.want_travel?getTravel("want_travel",$scope.otherUserInfo.want_travel):!0,$scope.otherUserInfo.love_sport?getConfig("love_sport",$scope.otherUserInfo.love_sport):!0,$scope.otherUserInfo.want_film?getConfig("want_film",$scope.otherUserInfo.want_film):!0,$scope.otherUserInfo.like_food?getConfig("like_food",$scope.otherUserInfo.like_food):!0}}),$scope.localChat=function(){window.location.hash="#/chat1?id="+$scope.otherUserInfo.id+"&head_pic="+$scope.otherUserInfo.info.head_pic+"&real_name="+$scope.otherUserInfo.info.real_name+"&sex="+$scope.otherUserInfo.sex+"&age="+$scope.otherUserInfo.info.age};var followData={};followData.user_id=ar.getCookie("bhy_user_id"),followData.follow_id=$scope.formData.userId,$scope.addFollow=function(){return followData.user_id==followData.follow_id?void ar.saveDataAlert($ionicPopup,"您不能关注自己"):-1!=dataFilter.data.blacked.indexOf(followData.follow_id)?void ar.saveDataAlert($ionicPopup,"您已被对方设置黑名单，关注失败"):void api.save("/wap/follow/add-follow",followData).success(function(e){e.data&&(document.getElementsByClassName("transition")[0].style.transition="all 0.5s",document.getElementsByClassName("transition")[1].style.transition="all 0.5s",$scope.formData.isfollow="1",ar.saveDataAlert($ionicPopup,"关注成功"))})}}]),module.controller("member.privacy",["app.serviceApi","$scope","$timeout","$ionicPopup",function(e,t,a,o){t.$on("$ionicView.beforeEnter",function(){e.list("/wap/follow/get-sum-black",{}).success(function(e){t.blackSum=e.data})}),t.userInfo=ar.getStorage("userInfo"),t.userInfo.info=JSON.stringify(t.userInfo.info),t.userInfo.auth=JSON.stringify(t.userInfo.auth)}]),module.controller("member.privacy_pic",["app.serviceApi","$scope","$timeout","$ionicPopup","$location",function(e,t,a,o,r){t.formData={},t.formData.privacy_pic=t.userInfo.privacy_pic?t.userInfo.privacy_pic:1,t.saveData=function(){t.userInfo.privacy_pic=t.formData.privacy_pic,e.save("/wap/member/save-data",t.userInfo).success(function(e){ar.setStorage("userInfo",t.userInfo);var a=ar.getStorage("userInfo");a.info=JSON.stringify(a.info),a.auth=JSON.stringify(a.auth),ar.setStorage("userInfo",a),ar.saveDataAlert(o,"保存成功"),r.url("/member/privacy")})}}]),module.controller("member.privacy_infoSafe",["app.serviceApi","$scope","$timeout","$ionicPopup","$location",function(e,t,a,o,r){t.loading=!1,t.infoSafe=function(){if(t.userInfo.info.level<1){var a=o.alert({template:"开通VIP，立即享受资料保护",okText:"现在去开通"});return a.then(function(){r.url("/member/vip")}),!1}if(1==t.userInfo.is_show){var i=o.confirm({title:"重要提示",template:"您确定要开启资料保护吗？开启后在您未主动联系其他会员时，他人均不可搜索及浏览您的资料。",okText:"我确定",cancelText:"再考虑一下"});i.then(function(a){a&&(t.loading=!0,t.userInfo.is_show="0",e.save("/wap/member/save-data",t.userInfo).success(function(e){if(t.loading=!1,e.status<1)return t.userInfo.is_show="1",ar.saveDataAlert(o,e.msg),!1;ar.setStorage("userInfo",t.userInfo);var a=ar.getStorage("userInfo");a.info=JSON.stringify(a.info),a.auth=JSON.stringify(a.auth),ar.setStorage("userInfo",a)}))})}else t.loading=!0,t.userInfo.is_show="1",e.save("/wap/member/save-data",t.userInfo).success(function(e){if(t.loading=!1,e.status<1)return ar.saveDataAlert(o,e.msg),t.userInfo.is_show="0",!1;ar.setStorage("userInfo",t.userInfo);var a=ar.getStorage("userInfo");a.info=JSON.stringify(a.info),a.auth=JSON.stringify(a.auth),ar.setStorage("userInfo",a)})}}]),module.controller("member.privacy_wechat",["app.serviceApi","$scope","$timeout","$ionicPopup",function(e,t,a,o){t.formData=[],t.formData.privacy_wechat=t.userInfo.privacy_wechat?t.userInfo.privacy_wechat:1,t.$on("$ionicView.afterLeave",function(){e.save("/wap/member/save-data",t.formData).success(function(e){t.userInfo.privacy_wechat=t.formData.privacy_wechat,ar.setStorage("userInfo",t.userInfo);var a=ar.getStorage("userInfo");a.info=JSON.stringify(a.info),a.auth=JSON.stringify(a.auth),ar.setStorage("userInfo",a)})})}]),module.controller("member.privacy_qq",["app.serviceApi","$scope","$timeout","$ionicPopup",function(e,t,a,o){t.formData=[],t.formData.privacy_qq=t.userInfo.privacy_qq?t.userInfo.privacy_qq:1,t.$on("$ionicView.afterLeave",function(){e.save("/wap/member/save-data",t.formData).success(function(e){t.userInfo.privacy_qq=t.formData.privacy_qq,ar.setStorage("userInfo",t.userInfo);var a=ar.getStorage("userInfo");a.info=JSON.stringify(a.info),a.auth=JSON.stringify(a.auth),ar.setStorage("userInfo",a)})})}]),module.controller("member.privacy_black",["app.serviceApi","$scope","$timeout","$ionicPopup",function(e,t,a,o){t.followList=[],e.list("/wap/follow/black-list",{}).success(function(e){t.followList=e.data;for(var a in t.followList)t.followList[a].info=JSON.parse(t.followList[a].info),t.followList[a].auth=JSON.parse(t.followList[a].auth)}),t.removeItem=function(a,o){e.save("/wap/follow/del-black",{id:o.id}).success(function(e){t.followList.splice(a,1)})},t.delTitle="解除",t.shouldShowDelete=!1,t.showDeleteBtn=function(){t.shouldShowDelete=!t.shouldShowDelete,t.shouldShowDelete?t.delTitle="完成":t.delTitle="解除"}}]),module.controller("member.security",["app.serviceApi","$scope","$timeout","$ionicPopup","$location",function(e,t,a,o,r){t.formData=[]}]),module.controller("member.security_pass",["app.serviceApi","$scope","$timeout","$ionicPopup","$location",function(e,t,a,o,r){t.formData=[],t.saveData=function(){return""==t.formData.pass?(ar.saveDataAlert(o,"请填写旧密码"),!1):""==t.formData.new_pass1||t.formData.new_pass1.length<6?(ar.saveDataAlert(o,"密码长度必须大于6个字符"),!1):t.formData.new_pass1!=t.formData.new_pass1?(ar.saveDataAlert(o,"新密码不一致"),!1):void e.save("/wap/user/reset-password",t.formData).success(function(e){if(e.data){ar.saveDataAlert(o,"密码修改成功"),t.userInfo.reset_pass_time=parseInt(e.data),ar.setStorage("userInfo",t.userInfo);var a=ar.getStorage("userInfo");a.info=JSON.stringify(a.info),a.auth=JSON.stringify(a.auth),ar.setStorage("userInfo",a),r.url("/member/security")}else ar.saveDataAlert(o,"密码修改失败")})}}]),module.controller("member.security_phone",["app.serviceApi","$scope","$timeout","$ionicPopup","$interval","$location",function(e,t,a,o,r,i){t.formData={},t.getCodeTitle="获取验证码",t.getCode=function(){return ar.trim(t.formData.phone)?ar.validateMobile(t.formData.phone)?void e.getMobileIsExist(t.formData.phone).success(function(a){if(a.status<1)return ar.saveDataAlert(o,"该手机号码已存在"),!1;var i=90,n=r(function(){t.getCodeTitle="重新获取("+i+")"},1e3,90);n.then(function(){t.getCodeTitle="获取验证码",r.cancel(n)},function(){ar.saveDataAlert(o,"倒计时出错")},function(){i-=1}),e.sendCodeMsg(t.formData.phone).success(function(e){return e.status<1?(r.cancel(n),ar.saveDataAlert(o,e.msg),!1):void 0})}):(ar.saveDataAlert(o,"手机号码格式不正确"),!1):(ar.saveDataAlert(o,"请输入您的手机号码"),!1)},t.bindNow=function(){return ar.validateMobile(t.formData.phone)?void e.getMobileIsExist(t.formData.phone).success(function(a){return a.status<1?(ar.saveDataAlert(o,"该手机号码已存在"),!1):void e.validateCode(t.formData.code).success(function(a){return a.status?void e.save("/wap/user/update-user-data",{phone:t.formData.phone}).success(function(e){if(e.data){t.userInfo.phone=t.formData.phone,ar.setStorage("userInfo",t.userInfo);var a=ar.getStorage("userInfo");a.info=JSON.stringify(a.info),a.auth=JSON.stringify(a.auth),ar.setStorage("userInfo",a);var r=o.alert({title:"重要提示",template:"绑定成功，您的初始密码为："+ar.getPassByPhone(t.formData.phone)+"，请及时修改您的密码。"});r.then(function(e){i.url("/member/security")})}else ar.saveDataAlert(o,"手机绑定失败")}):(ar.saveDataAlert(o,"验证码不正确"),!1)})}):(ar.saveDataAlert(o,"手机号码格式不正确"),!1)}}]),module.controller("member.edit_phone",["app.serviceApi","$scope","$timeout","$ionicPopup","$interval","$location",function(e,t,a,o,r,i){t.formData={},t.codeTitle="获取验证码",t.getCode=function(){if(t.formData.phone!=parseInt(t.userInfo.phone))return ar.saveDataAlert(o,"旧手机号码错误！"),!1;var a=60,i=r(function(){t.codeTitle="重新获取("+a+")"},1e3,60);i.then(function(){t.codeTitle="获取验证码",r.cancel(i)},function(){},function(){a-=1}),e.sendCodeMsg(t.userInfo.phone).success(function(e){e.status||ar.saveDataAlert(o,"短信发送失败，请稍后重试。")})},t.next=function(){return t.formData.phone!=parseInt(t.userInfo.phone)?(ar.saveDataAlert(o,"旧手机号码错误！"),!1):void e.validateCode(t.formData.code).success(function(e){return e.status?void i.url("/member/edit_phone_new"):(ar.saveDataAlert(o,"验证码错误"),!1)})}}]),module.controller("member.edit_phone_new",["app.serviceApi","$scope","$timeout","$ionicPopup","$interval","$location",function(e,t,a,o,r,i){t.formData={},t.getCodeTitle="获取验证码",t.getCode=function(){return ar.trim(t.formData.phone)?ar.validateMobile(t.formData.phone)?void e.getMobileIsExist(t.formData.phone).success(function(a){if(a.status<1)return ar.saveDataAlert(o,"该手机号码已存在"),!1;var i=90,n=r(function(){t.getCodeTitle="重新获取("+i+")"},1e3,90);n.then(function(){t.getCodeTitle="获取验证码",r.cancel(n)},function(){ar.saveDataAlert(o,"倒计时出错")},function(){i-=1}),e.sendCodeMsg(t.formData.phone).success(function(e){return e.status<1?(r.cancel(n),ar.saveDataAlert(o,e.msg),!1):void 0})}):(ar.saveDataAlert(o,"手机号码格式不正确"),!1):(ar.saveDataAlert(o,"请输入您的手机号码"),!1)},t.bindNow=function(){return ar.validateMobile(t.formData.phone)?void e.getMobileIsExist(t.formData.phone).success(function(a){return a.status<1?(ar.saveDataAlert(o,"该手机号码已存在"),!1):void e.validateCode(t.formData.code).success(function(a){return a.status?void e.save("/wap/user/update-user-data",{phone:t.formData.phone}).success(function(e){if(e.data){t.userInfo.phone=t.formData.phone,ar.setStorage("userInfo",t.userInfo);var a=ar.getStorage("userInfo");a.info=JSON.stringify(a.info),a.auth=JSON.stringify(a.auth),ar.setStorage("userInfo",a),ar.saveDataAlert(o,"绑定成功"),i.url("/member/security")}else ar.saveDataAlert(o,"手机绑定失败")}):(ar.saveDataAlert(o,"验证码不正确"),!1)})}):(ar.saveDataAlert(o,"手机号码格式不正确"),!1)}}]),module.controller("member.security_wechat",["app.serviceApi","$scope","$timeout","$ionicPopup","$location",function(e,t,a,o,r){t.formData=[],t.formData.wechat=t.userInfo.info.wechat,t.saveData=function(){if(alert(t.formData.wechat),t.formData.wechat)e.save("/wap/member/save-data",t.formData).success(function(e){t.userInfo.info.wechat=t.formData.wechat,ar.setStorage("userInfo",t.userInfo);var a=ar.getStorage("userInfo");a.info=JSON.stringify(a.info),a.auth=JSON.stringify(a.auth),ar.setStorage("userInfo",a),
r.url("/member/security")});else{if(!confirm("检测到您还未填写微信号，确定放弃吗？"))return!1;r.url("/member/security")}}}]),module.controller("member.security_qq",["app.serviceApi","$scope","$timeout","$ionicPopup","$location",function(e,t,a,o,r){t.formData=[],t.formData.qq=t.userInfo.info.qq,t.saveData=function(){if(""==t.formData.qq||"undefined"==typeof t.formData.qq){if(!confirm("检测到您还未填写QQ号，确定放弃吗？"))return!1;r.url("/member/security")}else e.save("/wap/member/save-data",t.formData).success(function(e){t.userInfo.info.qq=t.formData.qq,ar.setStorage("userInfo",t.userInfo);var a=ar.getStorage("userInfo");a.info=JSON.stringify(a.info),a.auth=JSON.stringify(a.auth),ar.setStorage("userInfo",a),r.url("/member/security")})}}]),module.controller("member.honesty",["app.serviceApi","$scope","$timeout","$ionicPopup",function(e,t,a,o){e.list("/wap/member/honesty-photo",[]).success(function(e){t.sfzCheck=e.sfz,t.marrCheck=e.marr,t.eduCheck=e.edu,t.housingCheck=e.housing})}]),module.controller("member.honesty_sfz",["app.serviceApi","$scope","$timeout","$ionicPopup","FileUploader","$location",function(e,t,a,o,r,i){var n=t.uploader=new r({url:"/wap/file/thumb"});e.list("/wap/member/photo-list",{type:23,pageSize:2}).success(function(e){t.authList=e.data}),t.imgList=[],ar.initPhotoSwipeFromDOM(".bhy-gallery",t,o),t.formData=[],t.formData.real_name=t.userInfo.info.real_name,t.addNewImg=function(e){t.uploaderImage(n,e),ar.initPhotoSwipeFromDOM(".bhy-gallery",t,o)},t.$on("thumb_path",function(e,a,o){"honesty1"==a?t.authList[0]?t.authList[0].thumb_path=o.thumb_path:t.authList[0]=o:t.authList[1]?t.authList[1].thumb_path=o.thumb_path:t.authList[1]=o}),t.saveData=function(){return t.authList[0]?t.authList[1]?t.formData.real_name?(t.authList[0].type=2,t.authList[1].type=3,void e.save("/wap/member/save-photo",t.authList).success(function(a){var o=[];o.identity=t.formData.real_name,t.userInfo.info.real_name=t.formData.real_name,t.userInfo.has_identify=1,e.save("/wap/member/save-data",t.userInfo).success(function(e){ar.setStorage("userInfo",t.userInfo);var a=ar.getStorage("userInfo");a.info=JSON.stringify(a.info),a.auth=JSON.stringify(a.auth),ar.setStorage("userInfo",a),i.url("/member/honesty"),t.sfzCheck=2})})):(ar.saveDataAlert(o,"请填写您的真实姓名，本站前台只显示您的姓氏。"),!1):(ar.saveDataAlert(o,"请上传身份证反面照片"),!1):(ar.saveDataAlert(o,"请上传身份证正面照片"),!1)}}]),module.controller("member.honesty_marr",["app.serviceApi","$scope","$timeout","$ionicPopup","FileUploader",function(e,t,a,o,r){e.list("/wap/member/photo-list",{type:5,pageSize:1}).success(function(e){t.authList=e.data,ar.initPhotoSwipeFromDOM(".bhy-gallery",t,o)}),t.imgList=[];var i=t.uploader=new r({url:"/wap/file/auth-pictures?type=5"});t.addNewImg=function(e){t.uploaderImage(i,e),ar.initPhotoSwipeFromDOM(".bhy-gallery",t,o)},t.$on("thumb_path",function(e,a,r){t.authList[0]?t.authList[0].thumb_path=r.thumb_path:t.authList[0]=r,ar.initPhotoSwipeFromDOM(".bhy-gallery",t,o),ar.saveDataAlert(o,"上传成功")})}]),module.controller("member.honesty_edu",["app.serviceApi","$scope","$timeout","$ionicPopup","FileUploader",function(e,t,a,o,r){e.list("/wap/member/photo-list",{type:4,pageSize:1}).success(function(e){t.authList=e.data,ar.initPhotoSwipeFromDOM(".bhy-gallery",t,o)}),t.imgList=[];var i=t.uploader=new r({url:"/wap/file/auth-pictures?type=4"});t.addNewImg=function(e){t.uploaderImage(i,e)},t.$on("thumb_path",function(e,a,r){t.authList[0]?t.authList[0].thumb_path=r.thumb_path:t.authList[0]=r,ar.initPhotoSwipeFromDOM(".bhy-gallery",t,o),ar.saveDataAlert(o,"上传成功")})}]),module.controller("member.honesty_housing",["app.serviceApi","$scope","$timeout","$ionicPopup","FileUploader",function(e,t,a,o,r){e.list("/wap/member/photo-list",{type:6,pageSize:1}).success(function(e){t.authList=e.data,ar.initPhotoSwipeFromDOM(".bhy-gallery",t,o)}),t.imgList=[];var i=t.uploader=new r({url:"/wap/file/auth-pictures?type=6"});t.addNewImg=function(e){t.uploaderImage(i,e)},t.$on("thumb_path",function(e,a,r){t.authList[0]?t.authList[0].thumb_path=r.thumb_path:t.authList[0]=r,ar.initPhotoSwipeFromDOM(".bhy-gallery",t,o),ar.saveDataAlert(o,"上传成功")})}]),module.controller("member.vip",["app.serviceApi","$scope","$timeout","$ionicPopup","$interval","$location",function(e,t,a,o,r,i){t.formData=[],e.save("/wap/charge/get-charge-goods-list",{type:1}).success(function(e){t.goodsList=e}),t.createOrder=function(t){e.save("/wap/charge/produce-order",{goodsId:t,user_id:ar.getCookie("bhy_user_id")}).success(function(e){e.status<1?ar.saveDataAlert(o,e.msg):i.url("/charge_index?orderId="+e.data)})}}]),module.controller("member.account",["app.serviceApi","$scope","$timeout","$ionicPopup",function(e,t,a,o){t.find=!0,t.showMoney=function(){t.find=!1,a(function(){t.loading=!0,e.get("/wap/member/get-user-balance",{}).success(function(e){t.loading=!1,t.money=parseInt(e.data.balance)})},800)},t.timestamp=ar.timeStamp(),e.get("/wap/member/get-user-service-info",{}).success(function(e){t.serviceInfo=e.data,t.serviceInfo.level=ar.cleanQuotes(t.serviceInfo.level),console.log(t.serviceInfo)})}]),module.controller("member.balance",["app.serviceApi","$scope","$timeout","$ionicPopup","$location",function(e,t,a,o,r){t.formData={},t.formData.customize=10,t.pay=function(){return!t.formData.money||t.formData.money<1?(ar.saveDataAlert(o,"选择充值金额异常，请刷新重试！"),!1):void e.save("/wap/charge/produce-order",{goodsId:8,money:t.formData.money}).success(function(e){e.status<1?ar.saveDataAlert(o,e.msg):r.url("/charge_index?orderId="+e.data)})},t.customizePay=function(){return t.formData.customize?t.formData.customize<1||t.formData.customize>2e4?(ar.saveDataAlert(o,"单次最少充值1元，最多充值20000元。"),!1):void e.save("/wap/charge/produce-order",{goodsId:9,money:t.formData.customize}).success(function(e){e.status<1?ar.saveDataAlert(o,e.msg):r.url("/charge_index?orderId="+e.data)}):(ar.saveDataAlert(o,"请您输入充值金额！"),!1)}}]),module.controller("member.account_record",["app.serviceApi","$scope","$timeout","$ionicPopup","$location",function(e,t,a,o,r){t.recordList=[],e.get("/wap/member/get-record-list",{}).success(function(e){e.status>0&&(t.recordList=e.data)}),t.pageSize=1,t.isMore=!0,t.loadMoreData=function(){t.pageSize>t.recordList.length&&(t.isMore=!1),t.pageSize+=1,t.$broadcast("scroll.infiniteScrollComplete")},t.moreDataCanBeLoaded=function(){return t.isMore}}]),module.controller("member.account_record_info",["app.serviceApi","$scope","$timeout","$ionicPopup","$location",function(e,t,a,o,r){t.item=angular.fromJson(r.$$search.item)}]),module.controller("member.account_bribery",["app.serviceApi","$scope","$timeout","$ionicPopup","$location","$filter",function(e,t,a,o,r,i){t.tab=1,t.yearList=[];for(var n=2016;n<=(new Date).getFullYear();n++)t.yearList.push({id:n,name:n+"年"});t.year=t.yearList[t.yearList.length-1].id,t.briberyList=[],e.list("/wap/member/bribery-list",{flag:!1,page:t.page}).success(function(e){var a=ar.cleanQuotes(JSON.stringify(e.data));t.briberyList=t.briberyList.concat(JSON.parse(a))}),e.list("/wap/member/bribery-list",{flag:!0,page:t.page}).success(function(e){var a=ar.cleanQuotes(JSON.stringify(e.data));t.briberyList=t.briberyList.concat(JSON.parse(a))}),t.numAndmoney={number:0,money:0};for(var n in t.briberyList)t.briberyList[n].flag==t.tab&&1==t.briberyList[n].status&&t.briberyList[n].year==t.year&&(t.numAndmoney.number+=1,t.numAndmoney.money+=t.briberyList[n].money);t.isMore=!0,t.pageSize=5,t.loadMore=function(){t.pageSize>t.numAndmoney.number&&(t.isMore=!1),t.pageSize+=5,t.$broadcast("scroll.infiniteScrollComplete")},t.moreDataCanBeLoaded=function(){return t.isMore},t.showTab=function(e){t.numAndmoney.number=0,t.numAndmoney.money=0,t.tab=e;for(var a in t.briberyList)t.briberyList[a].flag==e&&1==t.briberyList[a].status&&t.briberyList[a].year==t.year&&(t.numAndmoney.number+=1,t.numAndmoney.money+=t.briberyList[a].money)}}]),module.controller("member.account_withdraw",["app.serviceApi","$scope","$timeout","$ionicPopup","$ionicModal","$interval","$ionicLoading","$location",function(e,t,a,o,r,i,n,s){t.formData=[],t.form=[],t.codeTitle="获取验证码",e.get("/wap/member/get-user-balance",{}).success(function(e){t.money=parseInt(e.data.balance)/100}),t.phone=t.userInfo.phone,r.fromTemplateUrl("selectCardModal.html",{scope:t,animation:"slide-in-up"}).then(function(e){t.modal=e}),t.showSelectCard=function(){t.modal.show()},t.selectedCard=function(){t.modal.hide()},e.list("/wap/member/cash-card-list").success(function(e){t.cardList=e.data,t.formData.bank=t.cardList[0]}),t.getCode=function(){if(t.form.phone!=t.phone)return ar.saveDataAlert(o,"输入的手机号码与绑定手机号码不符，请检查！"),!1;e.sendCodeMsg(t.form.phone).success(function(e){e||ar.saveDataAlert(o,"获取验证码失败")});var a=60,r=i(function(){t.codeTitle="重新获取("+a+")"},1e3,60);r.then(function(){t.codeTitle="获取验证码",i.cancel(r)},function(){ar.saveDataAlert(o,"倒计时出错")},function(){a-=1})},t.saveData=function(){n.show({template:"处理中..."}),e.validateCode(t.form.code).success(function(a){return a.status?void e.get("/wap/member/add-cash-info",{money:t.formData.money,cash_card_id:t.formData.bank.id}).success(function(e){n.hide(),e.status>0?s.url("/member/account_withdraw_info?id="+e.data):ar.saveDataAlert(o,e.msg)}):(n.hide(),void ar.saveDataAlert(o,"验证码错误"))})}}]),module.controller("member.account_withdraw_info",["app.serviceApi","$scope","$timeout","$ionicPopup","$ionicModal","$interval","$ionicLoading","$location",function(e,t,a,o,r,i,n,s){r.fromTemplateUrl("statusModal.html",{scope:t,animation:"slide-in-up"}).then(function(e){t.modal=e}),t.showStatus=function(){t.modal.show()},t.hideStatus=function(){t.modal.hide()},t.withdrawInfo={},e.get("/wap/member/get-withdraw-info-by-id",{id:s.$$search.id}).success(function(e){t.withdrawInfo=e.data})}]),module.controller("member.account_mycard",["app.serviceApi","$scope","$timeout","$ionicPopup",function(e,t,a,o){e.list("/wap/member/cash-card-list").success(function(e){t.cardList=e.data}),t["delete"]=function(a,r){var i=o.confirm({title:"确定删除？",template:!1,cancelText:"点错了",okText:"确定"});i.then(function(i){return i?void e.save("/wap/member/del-card",{id:r.id}).success(function(e){e.status>0?t.cardList.splice(a,1):ar.saveDataAlert(o,e.msg)}):!1})}}]),module.controller("member.account_mycard_info",["app.serviceApi","$scope","$timeout","$ionicPopup","$location",function(e,t,a,o,r){t.cardId=r.$$search.id,e.list("/wap/member/cash-card-by-id",{id:t.cardId}).success(function(e){t.bankData=e.data})}]),module.controller("member.account_add_card",["app.serviceApi","$scope","$timeout","$ionicPopup","$location",function(e,t,a,o,r){t.formData=[],t.formData.user_name=t.userInfo.info.real_name,e.list("/wap/member/bank-list",{}).success(function(e){t.bankData=e.data}),t.bankNameChain=function(){if(!t.formData.card_no)return ar.saveDataAlert(o,"请输入银行卡号"),!1;if(19!=t.formData.card_no.length&&16!=t.formData.card_no.length)return ar.saveDataAlert(o,"请核对银行卡号是否正确"),!1;for(var e in t.bankData)if(-1!=t.formData.card_no.indexOf(t.bankData[e].bin)){t.bankData[e].name.split("-"),t.formData.name=t.bankData[e].name.split("-")[0]+"-"+t.bankData[e].name.split("-")[2];break}},t.saveData=function(){return t.formData.card_no?19!=t.formData.card_no.length&&16!=t.formData.card_no.length?(ar.saveDataAlert(o,"请核对银行卡号是否正确"),!1):t.formData.name?void e.save("/wap/member/add-cash-card",t.formData).success(function(e){e.status>0?r.url(r.$$search.tempUrl):ar.saveDataAlert(o,e.msg)}):(ar.saveDataAlert(o,"未自动补全卡类型，请核对您的银行卡号！"),!1):(ar.saveDataAlert(o,"请输入银行卡号"),!1)}}]),module.controller("member.rendezvous",["app.serviceApi","$scope","$timeout","$ionicPopup",function(e,t,a,o){}]),module.controller("member.rendezvous_add",["app.serviceApi","$scope","$timeout","$ionicPopup","$ionicModal","$location",function(e,t,a,o,r,i){t.formData=[],i.$$search.id&&e.list("/wap/rendezvous/get-rendezvous-info",{id:i.search().id}).success(function(e){t.formData=e.data,t.formData.theme=parseInt(t.formData.theme)}),t.jump=function(){i.$$search.tempUrl?i.url("/rendezvous"):i.url("/member/rendezvous")},r.fromTemplateUrl("themeModal.html",{scope:t,animation:"slide-in-up"}).then(function(e){t.themeModal=e}),t.openThemeModal=function(){t.themeModal.show()},t.closeThemeModal=function(){t.themeModal.hide()},r.fromTemplateUrl("themeTitleModal.html",{scope:t,animation:"slide-in-up"}).then(function(e){t.themeTitleModal=e}),t.openThemeTitleModal=function(){t.themeTitleModal.show()},t.closeThemeTitleModal=function(){t.themeTitleModal.hide()},r.fromTemplateUrl("sexModal.html",{scope:t,animation:"slide-in-up"}).then(function(e){t.sexModal=e}),t.openSexModal=function(){t.sexModal.show()},t.closeSexModal=function(){t.sexModal.hide()},r.fromTemplateUrl("fromModal.html",{scope:t,animation:"slide-in-up"}).then(function(e){t.fromModal=e}),t.openFromModal=function(){t.fromModal.show()},t.closeFromModal=function(){t.fromModal.hide()},r.fromTemplateUrl("destinationModal.html",{scope:t,animation:"slide-in-up"}).then(function(e){t.destinationModal=e}),t.openDestinationModal=function(){t.destinationModal.show()},t.closeDestinationModal=function(){t.destinationModal.hide()},r.fromTemplateUrl("dateModal.html",{scope:t,animation:"slide-in-up"}).then(function(e){t.dateModal=e}),t.openDateModal=function(){t.dateModal.show()},t.closeDateModal=function(){t.dateModal.hide()},r.fromTemplateUrl("moneyModal.html",{scope:t,animation:"slide-in-up"}).then(function(e){t.moneyModal=e}),t.openMoneyModal=function(){t.moneyModal.show()},t.closeMoneyModal=function(){t.moneyModal.hide()},r.fromTemplateUrl("requirementModal.html",{scope:t,animation:"slide-in-up"}).then(function(e){t.requirementModal=e}),t.openRequirementModal=function(){t.requirementModal.show()},t.closeRequirementModal=function(){t.requirementModal.hide()},t.formData.sex="0",t.formData.themeList=[{id:1,title:"娱乐"},{id:2,title:"美食"},{id:3,title:"旅游"},{id:4,title:"运动健身"},{id:-1,title:"其他"}],t.saveData=function(){return t.formData.rendezvous_time=1475475e3,t.formData.theme?t.formData.title?t.formData.destination?t.formData.rendezvous_time?t.formData.fee_des?void e.save("/wap/rendezvous/release",t.formData).success(function(e){e.data&&(ar.saveDataAlert(o,"发布成功！"),i.url("/member/rendezvous_put"))}):(ar.saveDataAlert(o,"请选择费用说明"),!1):(ar.saveDataAlert(o,"请填写出发时间"),!1):(ar.saveDataAlert(o,"请填写目的地"),!1):(ar.saveDataAlert(o,"请填写约会标题"),!1):(ar.saveDataAlert(o,"请选择约会主题"),!1)}}]),module.controller("member.rendezvous_theme",["app.serviceApi","$scope","$timeout","$ionicPopup",function(e,t,a,o){t.selTheme=function(){t.closeThemeModal()}}]),module.controller("member.rendezvous_themeTitle",["app.serviceApi","$scope","$timeout","$ionicPopup",function(e,t,a,o){t.save=function(){t.closeThemeTitleModal(),console.info(t.formData.themeTitle,t.formData.content)}}]),module.controller("member.rendezvous_sex",["app.serviceApi","$scope","$timeout","$ionicPopup",function(e,t,a,o){t.selSex=function(){t.closeSexModal(),console.log(t.formData.sex)}}]),module.controller("member.rendezvous_from",["app.serviceApi","$scope","$timeout","$ionicPopup",function(e,t,a,o){t.saveFrom=function(){t.closeFromModal(),console.log(t.formData.from)}}]),module.controller("member.rendezvous_destination",["app.serviceApi","$scope","$timeout","$ionicPopup",function(e,t,a,o){t.saveDestination=function(){t.closeDestinationModal(),console.log(t.formData.destination)}}]),module.controller("member.rendezvous_date",["app.serviceApi","$scope","$timeout","$ionicPopup",function(e,t,a,o){t.saveDate=function(){t.closeDateModal(),console.log(t.formData.rendezvous_time)}}]),module.controller("member.rendezvous_money",["app.serviceApi","$scope","$timeout","$ionicPopup",function(e,t,a,o){t.selMoney=function(){t.closeMoneyModal(),console.log(t.formData.fee_des)}}]),module.controller("member.rendezvous_requirement",["app.serviceApi","$scope","$timeout","$ionicPopup",function(e,t,a,o){t.userSex=0,t.labelList=config_infoData.label,t.lab=[],t.nothing=!1,t.addLabel=function(e){-1==t.lab.indexOf(e)&&t.lab.push(e),"不限"==e&&(t.lab=[],t.lab.push(e),t.nothing=!0)},t.removeLabel=function(e,a){"不限"==a&&(t.nothing=!1),t.lab.splice(e,1)},t.saveRequirement=function(){t.closeRequirementModal(),t.formData.we_want=t.lab.join(","),console.log(t.formData.we_want)}}]),module.controller("member.rendezvous_put",["app.serviceApi","$scope","$timeout","$ionicPopup","$ionicActionSheet","$location","$ionicScrollDelegate",function(e,t,a,o,r,i,n){t.formData=[],t.dateList=[],t.putList=[],t.formData.pageNum=0;for(var s=function(a,o){var r=[];r.user_id=ar.getCookie("bhy_user_id"),r.pageNum=o+1,r.date=a,t.formData.date=a,t.formData.pageNum=o+1,e.list("/wap/rendezvous/list",r).success(function(e){e.data.length<10?t.isMore=!1:t.isMore=!0;for(var a in e.data){var o=e.data[a].we_want.split(",");e.data[a].label=[],e.data[a].label=o,t.putList.push(e.data[a])}t.$broadcast("scroll.infiniteScrollComplete")})},c=function(t,a){var o=[];o.id=t,o.status=a,e.save("/wap/rendezvous/update-status",o).success(function(e){})},l=0;6>l;l++){var u=new Date;u.setMonth(u.getMonth()-l);var f=u.getFullYear()+"年"+(u.getMonth()+1)+"月",m=u.getFullYear()+"-"+(u.getMonth()+1);t.dateList.push({title:f,value:u.toLocaleString(),time:m})}t.dateTitle=t.dateList[0].title;var p=t.dateList[0].time.split("-");t.formData.year=p[0],t.formData.month=p[1]<10?"0"+p[1]:p[1],t.datePicker=!1,t.showDate=function(){t.datePicker=!t.datePicker},t.seletedDate=function(e,a){t.dateTitle=e;var o=a.split("-");t.formData.year=o[0],t.formData.month=o[1]<10?"0"+o[1]:o[1],s(a,0),t.putList=[],t.datePicker=!1},t.isMore=!0,t.loadMore=function(){s(t.formData.date,t.formData.pageNum)},t.moreDataCanBeLoaded=function(){return t.isMore},t.showhandle=function(e,a){var n=r.show({buttons:[{text:"关闭"},{text:"修改"}],destructiveText:"删除",titleText:"操作",cancelText:"取消",cancel:function(){},destructiveButtonClicked:function(){var e=o.confirm({title:"确定删除此条记录？删除后不可恢复。",template:!1,cancelText:"点错了",okText:"确定"});e.then(function(e){return e?(c(t.putList[a].id,0),t.putList.splice(a,1),n(),void 0):!1})},buttonClicked:function(e){0==e&&(t.putList[a].status="3",c(t.putList[a].r_id,3),n()),1==e&&i.url("/member/rendezvous_add?id="+t.putList[a].r_id)}})},t.involved=function(e,t,a){i.url("/member/rendezvous_involved?id="+e+"&theme="+t+"&title="+a)},t.openTxt=!1,t.openText=function(e){e.stopPropagation(),t.openTxt=!0}}]),module.controller("member.rendezvous_part",["app.serviceApi","$scope","$timeout","$ionicPopup",function(e,t,a,o){t.formData=[],t.partList=[],t.formData.pageNum=0;var r=function(a){var o=[];o.user_id=ar.getCookie("bhy_user_id"),o.pageNum=a+1,t.formData.pageNum=a+1,e.list("/wap/rendezvous/apply-list",o).success(function(e){e.data.length<10?t.isMore=!1:t.isMore=!0;for(var a in e.data){var o=e.data[a].we_want.split(",");e.data[a].label=[],e.data[a].label=o,e.data[a].info=JSON.parse(e.data[a].info),e.data[a].auth=JSON.parse(e.data[a].auth),t.partList.push(e.data[a])}t.$broadcast("scroll.infiniteScrollComplete")})};t.isMore=!0,t.loadMore=function(){r(t.formData.pageNum)},t.moreDataCanBeLoaded=function(){return t.isMore},t.delPart=function(a,r){var i=o.confirm({title:"确定删除此条记录？删除后将不显示在对方参与列表。",template:!1,cancelText:"点错了",okText:"确定"});i.then(function(o){return o?void e.save("/wap/rendezvous/delete-apply",{id:a}).success(function(e){t.partList.splice(r,1)}):!1})},t.openTxt=!1,t.openText=function(e){e.stopPropagation(),t.openTxt=!0},t.acceptAlert=function(e){null==e||void 0==typeof e?ar.saveDataAlert(o,"请等待TA联系"):ar.saveDataAlert(o,"TA的手机号码："+e)}}]),module.controller("member.rendezvous_involved",["app.serviceApi","$scope","$timeout","$ionicPopup","$location",function(e,t,a,o,r){t.partList=[],t.rendzvous=[],t.involvedList=[],t.rendzvous.id=r.$$search.id,t.rendzvous.title=r.$$search.title,t.rendzvous.theme=r.$$search.theme,e.list("/wap/rendezvous/rendezvous-apply-list",{id:r.$$search.id}).success(function(e){t.involvedList=e.data;for(var a in e.data)t.involvedList[a].info=JSON.parse(e.data[a].info),t.involvedList[a].auth=JSON.parse(e.data[a].auth)}),t.isAccept=!1,t.isIgnore=!1,t.accept=function(a,r){var i=o.confirm({title:"确定接受吗？",template:!1,cancelText:"点错了",okText:"确定"});i.then(function(o){if(!o)return!1;var i=[];i.id=a,i.status=1,e.save("/wap/rendezvous/update-apply-status",i).success(function(e){t.involvedList[r].status=1}),t.isAccept=!0})},t.ignore=function(a,r){var i=o.confirm({title:"确定忽略吗？",template:!1,cancelText:"点错了",okText:"确定"});i.then(function(o){if(!o)return!1;var i=[];i.id=a,i.status=2,e.save("/wap/rendezvous/update-apply-status",i).success(function(e){t.involvedList[r].status=2}),t.isIgnore=!0})}}]),module.controller("member.matchmaker",["app.serviceApi","$scope","$timeout","$ionicPopup","$location","$filter",function(e,t,a,o,r,i){t.matchmakerList=[];var n=[];e.list("/wap/user/get-user-info",[]).success(function(a){t.userInfo=a.data,ar.setStorage("userInfo",a.data),t.userInfo&&(t.userInfo.info=JSON.parse(t.userInfo.info),t.userInfo.auth=JSON.parse(t.userInfo.auth)),t.userInfo.matchmaking&&"0"!=t.userInfo.matchmaking?(t.title="服务红娘",t.showTitle="专属红娘",t.showMatchmaker=!0,n.matchmaker=t.userInfo.matchmaking+"-"+t.userInfo.matchmaker):t.userInfo.matchmaker&&"0"!=t.userInfo.matchmaker?(t.showMatchmaker=!0,t.title="专属红娘",n.matchmaker=t.userInfo.matchmaker):(t.showMatchmaker=!1,t.title="值班红娘",n.matchmaker=0),e.list("/wap/matchmaker/user-matchmaker-list",n).success(function(e){t.matchmakerList=e.data,0==n.matchmaker&&t.matchmakerList.length>1&&(t.matchmakerList=[],t.matchmakerList[0]=e.data[0])})}),t.getMatchmakerList=function(){"服务红娘"==t.title?(t.title="专属红娘",t.showTitle="服务红娘",t.matchmakerList.reverse()):(t.title="服务红娘",t.showTitle="专属红娘",t.matchmakerList.reverse())},t.showPhone=function(){t.phone=t.matchmakerList[0].landline?t.matchmakerList[0].landline:t.matchmakerList[0].phone,ar.saveDataAlert(o,"电话："+t.phone)}}]),module.controller("member.matchmaker_info",["app.serviceApi","$scope","$timeout","$ionicPopup","$location",function(e,t,a,o,r){t.matchmakerList=[];var i=[];i.matchmaker=r.$$search.job,e.list("/wap/matchmaker/user-matchmaker-list",i).success(function(e){t.matchmakerList=e.data}),t.userInfo.matchmaking==i.matchmaker?t.title="服务红娘":t.userInfo.matchmaker==i.matchmaker?t.title="专属红娘":t.title="值班红娘"}]),module.controller("member.matchmaker_service",["app.serviceApi","$scope","$timeout","$ionicPopup","$location",function(e,t,a,o,r){}]),module.controller("member.about",["app.serviceApi","$scope","$timeout","$ionicPopup","$location",function(e,t,a,o,r){}]),module.controller("member.help",["app.serviceApi","$scope","$timeout","$ionicPopup","$location",function(e,t,a,o,r){}]),module.controller("member.help_notice",["app.serviceApi","$scope","$timeout","$ionicPopup","$location",function(e,t,a,o,r){}]),module.controller("member.help_appointment",["app.serviceApi","$scope","$timeout","$ionicPopup","$location",function(e,t,a,o,r){}]),module.controller("member.help_protocol",["app.serviceApi","$scope","$timeout","$ionicPopup","$location",function(e,t,a,o,r){}]),module.controller("member.help_rule",["app.serviceApi","$scope","$timeout","$ionicPopup","$location",function(e,t,a,o,r){}]),module.controller("member.report",["app.serviceApi","$scope","$timeout","$ionicPopup","$location",function(e,t,a,o,r){t.title=r.$$search.title,t.reportData={};var i={};t.report=function(){return t.reportData.item?(i.feedback_id=r.$$search.id,i.content=t.reportData.item,i.type=r.$$search.type,i.user_name=t.userInfo.info.real_name,i.feedback_name=r.$$search.userName,void e.save("/wap/member/add-feedback",i).success(function(e){1==e.status&&(ar.saveDataAlert(o,"您的举报信息我们已受理，我们会尽快核实情况并将处理结果反馈给您，谢谢您对我们的支持！"),r.url(r.$$search.tempUrl)),-1==e.status&&(ar.saveDataAlert(o,"情况核实中，请勿重复提交！"),r.url(r.$$search.tempUrl)),0==e.status&&ar.saveDataAlert(o,"举报失败，请刷新重试！")})):(ar.saveDataAlert(o,"请选择举报内容"),!1)}}]),module.controller("member.settings",["app.serviceApi","$scope","$timeout","$ionicPopup","$location","$ionicActionSheet","$ionicModal",function(e,t,a,o,r,i,n){t.formData={};var s=[];s.user_id=ar.getCookie("bhy_user_id"),s.follow_id=r.$$search.userId,e.list("/wap/follow/get-follow-status",s).success(function(e){e.status&&(0==e.data?(t.formData.pullBlack=!0,t.formData.follow=!1):1==e.data&&(t.formData.follow=!0,t.formData.pullBlack=!1))}),t.report=function(){if(s.user_id==s.follow_id)return void ar.saveDataAlert(o,"您不能举报自己");var a=i.show({buttons:[{text:"诽谤辱骂"},{text:"淫秽色情"},{text:"血腥暴力"},{text:"垃圾广告"},{text:'<p class="lh24 mb0">欺骗</p><p class="fs12 lh24 cor4 mb0">（酒托、话费托等骗取行为）</p>'},{text:'<p class="lh24 mb0">违法行为</p><p class="fs12 lh24 cor4 mb0">（涉毒、暴恐、违禁品等）</p>'},{text:"冒用他人照片"},{text:"资料不真实"}],titleText:"举报",cancelText:"取消",buttonClicked:function(i){e.save("/wap/member/add-feedback",{content:config_infoData.feedback[i],feedback_id:s.follow_id,feedback_name:r.$$search.userName,user_name:t.userInfo.info.real_name}).success(function(e){a(),e.status?ar.saveDataAlert(o,"举报成功，工作人员会尽快核实情况。"):ar.saveDataAlert(o,"举报失败，请刷新重试！")})}})},t.delFollow=function(){e.get("/wap/follow/del-follow",s).success(function(e){e.status?t.formData.follow=!1:ar.saveDataAlert(o,"取消关注失败")})},t.pullTheBlack=function(){if(t.formData.pullBlack){if(s.user_id==s.follow_id)return ar.saveDataAlert(o,"您不能拉黑自己"),void(t.formData.pullBlack=!1);var a=ar.saveDataConfirm(o,"确定将对方拉黑吗？拉黑后在“个人-隐私设置-黑名单”中解除。");a.then(function(a){return a?void e.save("/wap/follow/black-follow",s).success(function(e){return e.status?(t.formData.pullBlack=!0,ar.saveDataAlert(o,"已将对方列入黑名单，如需解除请至“个人-隐私设置-黑名单”中解除。"),!0):(ar.saveDataAlert(o,"操作失败，请刷新重试！"),!1)}):(t.formData.pullBlack=!1,!1)})}else t.delFollow(),console.log("取消拉黑")},n.fromTemplateUrl("reBackModal.html",{scope:t,animation:"slide-in-right"}).then(function(e){t.modal=e}),t.openModal=function(){t.modal.show()},t.closeModal=function(){t.modal.hide()}}]),module.controller("member.bindPhone",["app.serviceApi","$scope","$timeout","$ionicPopup","$location","$interval",function(e,t,a,o,r,i){t.formData={},t.getCodeTitle="获取验证码",t.getCode=function(){return ar.trim(t.formData.phone)?ar.validateMobile(t.formData.phone)?void e.getMobileIsExist(t.formData.phone).success(function(a){if(a.status<1)return ar.saveDataAlert(o,"该手机号码已存在"),!1;var r=90,n=i(function(){t.getCodeTitle="重新获取("+r+")"},1e3,90);n.then(function(){t.getCodeTitle="获取验证码",i.cancel(n)},function(){ar.saveDataAlert(o,"倒计时出错")},function(){r-=1}),e.sendCodeMsg(t.formData.phone).success(function(e){return e.status<1?(i.cancel(n),ar.saveDataAlert(o,e.msg),!1):void 0})}):(ar.saveDataAlert(o,"手机号码格式不正确"),!1):(ar.saveDataAlert(o,"请输入您的手机号码"),!1)},t.bindNow=function(){return ar.validateMobile(t.formData.phone)?void e.getMobileIsExist(t.formData.phone).success(function(a){return a.status<1?(ar.saveDataAlert(o,"该手机号码已存在"),!1):void e.validateCode(t.formData.code).success(function(a){return a.status?void e.save("/wap/user/update-user-data",{phone:t.formData.phone}).success(function(e){if(e.data){ar.saveDataAlert(o,"手机绑定成功"),t.userInfo.phone=t.formData.phone,ar.setStorage("userInfo",t.userInfo);var a=ar.getStorage("userInfo");a.info=JSON.stringify(a.info),a.auth=JSON.stringify(a.auth),ar.setStorage("userInfo",a),window.history.back()}else ar.saveDataAlert(o,"手机绑定失败")}):(ar.saveDataAlert(o,"验证码不正确"),!1)})}):(ar.saveDataAlert(o,"手机号码格式不正确"),!1)}}]),module});