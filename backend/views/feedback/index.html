
<div class="wrapper wrapper-content animated fadeInUp">
    <div class="ibox">
        <div class="ibox-title"><h5>举报管理</h5>
            <div class="ibox-tools rboor">

            </div>
        </div>

        <div class="ibox-content">

            <div class="form-horizontal clearfix">
                <div class="col-lg-12 col-sm-12">
                    <div class="form-group">
                        <div class="col-lg-12 col-sm-12 input-group date">
                            <a href="/admin/feedback/index?status=2" class="btn {{if (\Yii::$app->request->get('status') == 2)}} btn-success {{else}} btn-grey {{/if}}">待审核</a>
                            <a href="/admin/feedback/index?status=1" class="btn {{if (\Yii::$app->request->get('status') == 1)}} btn-success {{else}} btn-grey {{/if}}">审核属实</a>
                            <a href="/admin/feedback/index?status=3" class="btn {{if (\Yii::$app->request->get('status') == 3)}} btn-success {{else}} btn-grey {{/if}}">审核不属实</a>
                            <button class="btn" id="select-all">反选</button>


                        </div>
                    </div>
                </div>
            </div>

            <table id="demo1" class="table display  dataTable j-datatables"

                   cellspacing="0" width="100%">
                <thead>
                <tr>
                    <th class="tn">ID</th>
                    <th>举报人</th>
                    <th>被举报人</th>
                    <th>举报内容</th>
                    <th>举报类型</th>
                    <th>举报时间</th>
                    <th>状态</th>
                </tr>
                </thead>
                <tbody>
                {{foreach from=$list item=vo}}
                <tr data-id="{{$vo.id}}">
                    <td>{{$vo.id}}</td>
                    <td>{{$vo.user_id}}</td>
                    <td>{{$vo.feedback_id}}</td>
                    <td>{{$vo.content}}</td>
                    <td>
                        {{if ($vo.type == 1)}}
                        举报用户
                        {{else if ($vo.type == 2)}}
                        举报动态
                        {{/if}}
                    </td>
                    <td>{{date('Y-m-d H:i:s' ,  $vo.create_time)}}</td>
                    <td>
                        <!--<div class="make-switch switch-small" data-on-label="属实" {{if $vo.status == 2}} data-off-label="待审核"{{else}}data-off-label="不属实" {{/if}}data-on="success" data-off="danger">-->
                            <!--<input type="checkbox" data-id="{{$vo.id}}" class="mySwitch" {{if ($vo.status == 1)}} checked {{/if}}>-->
                        <!--</div>-->

                        <select class="form-control mySwitch" data-id="{{$vo.id}}">
                            <option value="2">待审核</option>
                            <option value="1">审核属实</option>
                            <option value="3">审核不属实</option>
                        </select>

                    </td>
                </tr>
                {{/foreach}}
                </tbody>
            </table>
        </div>
    </div>
</div>
<script>
    jQuery(document).ready(function () {
        $('.mySwitch').on('change', function () {
//            var status = $(this).is(':checked') == true ? 1 : 3;
            var status = $(this).val();
            var id = $(this).data('id');
            $.ajax({
                url: "/admin/feedback/auth", data: {id: id , status:status}, success: function (res) {

                }
            });
        });

        // 全选
        $("#select-all").click(function () {
            $(".j-datatables tbody tr").toggleClass('selected');
        })

        $('.j-datatables tbody').on( 'click', 'tr', function () {
            $(this).toggleClass('selected');
        } );

    })
</script>