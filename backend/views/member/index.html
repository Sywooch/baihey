<script src="/wechat/web/js/config/area.js"></script>
<script src="/wechat/web/js/config/city.js"></script>
<div class="wrapper wrapper-content animated fadeInUp">
    <div class="ibox">
        <div class="ibox-title"><h5>会员列表</h5>
            <div class="ibox-tools rboor">
                <a href="/admin/member/save" class="btn btn-green btn-xs p310"><i class="fa fa-plus"></i> 添加</a>
                <button class="btn btn-green btn-xs p310 del-user"><i class="fa fa-trash-o"></i> 删除</button>
            </div>
        </div>

        <div class="ibox-content">

            <div class="form-horizontal clearfix">
                <form action="/admin/member/index" method="get">
                    <div class="col-sm-12">
                        <div class="box-body big">
                            <div class="row form-group">
                                <div class="col-sm-2">
                                    <select name="status" class="form-control">
                                        <option value="">会员状态</option>
                                        <option {{if \Yii::$app->request->get('status') == 1}} selected {{/if}}
                                            value="1">未审核
                                        </option>
                                        <option {{if \Yii::$app->request->get('status') == 2}} selected {{/if}}
                                            value="2">已审核
                                        </option>
                                        <option {{if \Yii::$app->request->get('status') == 3}} selected {{/if}}
                                            value="3">黑名单
                                        </option>
                                        <option {{if \Yii::$app->request->get('status') == 4}} selected {{/if}}
                                            value="4">已删除
                                        </option>
                                    </select>
                                </div>
                                <div class="col-sm-2">
                                    <select name="is_show" class="form-control">
                                        <option value="">资料状态</option>
                                        <option {{if \Yii::$app->request->get('is_show') == 1}} selected
                                            {{/if}}value="1">开放
                                        </option>
                                        <option {{if \Yii::$app->request->get('is_show') == '0'}} selected
                                            {{/if}}value="0">关闭
                                        </option>
                                    </select>
                                </div>
                                <div class="col-sm-2">
                                    <select name="sex" class="form-control">
                                        <option value="">性别</option>
                                        <option value="0">女</option>
                                        <option value="1">男</option>

                                    </select>
                                </div>
                                <div class="col-sm-2">
                                    <select name="age1" class="form-control" id="age1">
                                        <option value="">最小年龄</option>
                                    </select>
                                </div>
                                <div class="col-sm-2">
                                    <select name="age2" class="form-control" id="age2">
                                        <option value="">最大年龄</option>
                                    </select>
                                </div>
                                <div class="col-sm-2">
                                    <select name="height" id="height" class="form-control">
                                        <option>身高</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row form-group">
                                <div class="col-sm-2">
                                    <select name="edu" class="form-control">
                                        <option>学历</option>
                                    </select>
                                </div>
                                <div class="col-sm-2">
                                    <select class="form-control">
                                        <option>年薪</option>
                                    </select>
                                </div>
                                <div class="col-sm-2">
                                    <select class="form-control">
                                        <option>婚姻</option>
                                    </select>
                                </div>
                                <div class="col-sm-2">
                                    <select class="form-control">
                                        <option>子女</option>
                                    </select>
                                </div>
                                <div class="col-sm-2">
                                    <select class="form-control">
                                        <option>职业</option>
                                    </select>
                                </div>
                                <div class="col-sm-2">
                                    <select class="form-control">
                                        <option>购房</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row form-group">
                                <div class="col-sm-2">
                                    <select class="form-control">
                                        <option>购车</option>
                                    </select>
                                </div>
                                <div class="col-sm-2">
                                    <select class="form-control">
                                        <option>等级</option>
                                    </select>
                                </div>
                                <div class="col-sm-2">
                                    <select class="form-control">
                                        <option>生肖</option>
                                    </select>
                                </div>
                                <div class="col-sm-2">
                                    <select class="form-control">
                                        <option>星座</option>
                                    </select>
                                </div>
                                <div class="col-sm-2">
                                    <select class="form-control">
                                        <option>销售红娘</option>
                                    </select>
                                </div>
                                <div class="col-sm-2">
                                    <select class="form-control">
                                        <option>服务红娘</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row form-group">
                                <div class="col-sm-2">
                                    <select class="form-control" id="provines" name="provines"
                                            onchange="bhyFunc.selectedProvines(this)">
                                        <option>省份</option>
                                    </select>
                                </div>
                                <div class="col-sm-2">
                                    <select class="form-control" id="citys" name="citys"
                                            onchange="bhyFunc.selectedCitys(this)">
                                        <option>城市</option>
                                    </select>
                                </div>
                                <div class="col-sm-2">
                                    <select class="form-control" id="area" name="area">
                                        <option>区县</option>
                                    </select>
                                </div>
                                <div class="col-sm-2">
                                    <input type="text" name="id_phone_name" class="form-control"
                                           value="{{\Yii::$app->request->get('id_phone_name')}}"
                                           placeholder="会员ID、手机号、姓名">
                                </div>
                                <div class="col-sm-2">
                                    <button type="submit" class="btn btn-primary btn-block">搜索</button>
                                </div>
                            </div>
                        </div>

                    </div>
                </form>
            </div>

            <table id="demo1" class="table  table-bordered    j-datatables"
                   data-is-ajax="1"
                   data-ajax-url="/admin/member/search"
                   cellspacing="0" width="100%">
                <thead>
                <tr>
                    <th>头像</th>
                    <th>ID</th>
                    <th>姓名</th>
                    <th>性别</th>
                    <th>年龄</th>
                    <th>婚姻</th>
                    <th>身高</th>
                    <th>学历</th>
                    <th>等级</th>
                    <th>服务</th>
                    <th>认证</th>
                    <th>签单</th>
                    <th>资料</th>
                    <th>地址</th>
                    <th>证件</th>
                    <th>状态</th>
                    <th>操作</th>
                </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </div>
</div>
<script>
    jQuery(document).ready(function () {

        bhyFunc.cityPickerInit();

        $('#age1,#age2').append(bhyFunc.ageLink(18));
        $('#age1').change(function(){
            if($(this).val()){
                $('#age2').empty().append('<option>最大年龄</option>'+ bhyFunc.ageLink($(this).val()));
            }else{
                $('#age2').empty().append('<option>最大年龄</option>'+ bhyFunc.ageLink(18));
            }
        })
        $('#height').append(bhyFunc.heightLink(140));


        $('.j-datatables tbody').on('click', 'tr', function () {
            $(this).toggleClass('selected');
        });

        $('.del-user').click(function () {
            if (confirm('确认删除')) {
                var id = [];
                $('table .selected').each(function () {
                    id.push($(this).children().next().html());
                })

                $.ajax({
                    type: 'post',
                    url: "/admin/member/del",
                    data: {id: id},
                    success: function (res) {
                        res = JSON.parse(res);
                        if (res.status == 1) {
                            window.location.reload();
                        }
                    }
                });
            }

        })
    });
</script>